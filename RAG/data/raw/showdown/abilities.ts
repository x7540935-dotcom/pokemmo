{
  "metadata": {
    "source": "pokemon-showdown",
    "type": "abilities",
    "fetchedAt": "2025-11-13T05:58:52.142Z"
  },
  "data": "/*\r\n\r\nRatings and how they work:\r\n\r\n-1: Detrimental\r\n\t  An ability that severely harms the user.\r\n\tex. Defeatist, Slow Start\r\n\r\n 0: Useless\r\n\t  An ability with no overall benefit in a singles battle.\r\n\tex. Color Change, Plus\r\n\r\n 1: Ineffective\r\n\t  An ability that has minimal effect or is only useful in niche situations.\r\n\tex. Light Metal, Suction Cups\r\n\r\n 2: Useful\r\n\t  An ability that can be generally useful.\r\n\tex. Flame Body, Overcoat\r\n\r\n 3: Effective\r\n\t  An ability with a strong effect on the user or foe.\r\n\tex. Chlorophyll, Sturdy\r\n\r\n 4: Very useful\r\n\t  One of the more popular abilities. It requires minimal support to be effective.\r\n\tex. Adaptability, Magic Bounce\r\n\r\n 5: Essential\r\n\t  The sort of ability that defines metagames.\r\n\tex. Imposter, Shadow Tag\r\n\r\n*/\r\n\r\nexport const Abilities: import('../sim/dex-abilities').AbilityDataTable = {\r\n\tnoability: {\r\n\t\tisNonstandard: \"Past\",\r\n\t\tflags: {},\r\n\t\tname: \"No Ability\",\r\n\t\trating: 0.1,\r\n\t\tnum: 0,\r\n\t},\r\n\tadaptability: {\r\n\t\tonModifySTAB(stab, source, target, move) {\r\n\t\t\tif (move.forceSTAB || source.hasType(move.type)) {\r\n\t\t\t\tif (stab === 2) {\r\n\t\t\t\t\treturn 2.25;\r\n\t\t\t\t}\r\n\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Adaptability\",\r\n\t\trating: 4,\r\n\t\tnum: 91,\r\n\t},\r\n\taerilate: {\r\n\t\tonModifyTypePriority: -1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tconst noModifyType = [\r\n\t\t\t\t'judgment', 'multiattack', 'naturalgift', 'revelationdance', 'technoblast', 'terrainpulse', 'weatherball',\r\n\t\t\t];\r\n\t\t\tif (move.type === 'Normal' && (!noModifyType.includes(move.id) || this.activeMove?.isMax) &&\r\n\t\t\t\t!(move.isZ && move.category !== 'Status') && !(move.name === 'Tera Blast' && pokemon.terastallized)) {\r\n\t\t\t\tmove.type = 'Flying';\r\n\t\t\t\tmove.typeChangerBoosted = this.effect;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.typeChangerBoosted === this.effect) return this.chainModify([4915, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Aerilate\",\r\n\t\trating: 4,\r\n\t\tnum: 184,\r\n\t},\r\n\taftermath: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (!target.hp && this.checkMoveMakesContact(move, source, target, true)) {\r\n\t\t\t\tthis.damage(source.baseMaxhp / 4, source, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Aftermath\",\r\n\t\trating: 2,\r\n\t\tnum: 106,\r\n\t},\r\n\tairlock: {\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\t// Air Lock does not activate when Skill Swapped or when Neutralizing Gas leaves the field\r\n\t\t\tthis.add('-ability', pokemon, 'Air Lock');\r\n\t\t\t((this.effect as any).onStart as (p: Pokemon) => void).call(this, pokemon);\r\n\t\t},\r\n\t\tonStart(pokemon) {\r\n\t\t\tpokemon.abilityState.ending = false; // Clear the ending flag\r\n\t\t\tthis.eachEvent('WeatherChange', this.effect);\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tpokemon.abilityState.ending = true;\r\n\t\t\tthis.eachEvent('WeatherChange', this.effect);\r\n\t\t},\r\n\t\tsuppressWeather: true,\r\n\t\tflags: {},\r\n\t\tname: \"Air Lock\",\r\n\t\trating: 1.5,\r\n\t\tnum: 76,\r\n\t},\r\n\tanalytic: {\r\n\t\tonBasePowerPriority: 21,\r\n\t\tonBasePower(basePower, pokemon) {\r\n\t\t\tlet boosted = true;\r\n\t\t\tfor (const target of this.getAllActive()) {\r\n\t\t\t\tif (target === pokemon) continue;\r\n\t\t\t\tif (this.queue.willMove(target)) {\r\n\t\t\t\t\tboosted = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (boosted) {\r\n\t\t\t\tthis.debug('Analytic boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Analytic\",\r\n\t\trating: 2.5,\r\n\t\tnum: 148,\r\n\t},\r\n\tangerpoint: {\r\n\t\tonHit(target, source, move) {\r\n\t\t\tif (!target.hp) return;\r\n\t\t\tif (move?.effectType === 'Move' && target.getMoveHitData(move).crit) {\r\n\t\t\t\tthis.boost({ atk: 12 }, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Anger Point\",\r\n\t\trating: 1,\r\n\t\tnum: 83,\r\n\t},\r\n\tangershell: {\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (\r\n\t\t\t\teffect.effectType === \"Move\" &&\r\n\t\t\t\t!effect.multihit &&\r\n\t\t\t\t!(effect.hasSheerForce && source.hasAbility('sheerforce'))\r\n\t\t\t) {\r\n\t\t\t\tthis.effectState.checkedAngerShell = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.effectState.checkedAngerShell = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryEatItem(item) {\r\n\t\t\tconst healingItems = [\r\n\t\t\t\t'aguavberry', 'enigmaberry', 'figyberry', 'iapapaberry', 'magoberry', 'sitrusberry', 'wikiberry', 'oranberry', 'berryjuice',\r\n\t\t\t];\r\n\t\t\tif (healingItems.includes(item.id)) {\r\n\t\t\t\treturn this.effectState.checkedAngerShell;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tonAfterMoveSecondary(target, source, move) {\r\n\t\t\tthis.effectState.checkedAngerShell = true;\r\n\t\t\tif (!source || source === target || !target.hp || !move.totalDamage) return;\r\n\t\t\tconst lastAttackedBy = target.getLastAttackedBy();\r\n\t\t\tif (!lastAttackedBy) return;\r\n\t\t\tconst damage = move.multihit ? move.totalDamage : lastAttackedBy.damage;\r\n\t\t\tif (target.hp <= target.maxhp / 2 && target.hp + damage > target.maxhp / 2) {\r\n\t\t\t\tthis.boost({ atk: 1, spa: 1, spe: 1, def: -1, spd: -1 }, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Anger Shell\",\r\n\t\trating: 3,\r\n\t\tnum: 271,\r\n\t},\r\n\tanticipation: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tfor (const target of pokemon.foes()) {\r\n\t\t\t\tfor (const moveSlot of target.moveSlots) {\r\n\t\t\t\t\tconst move = this.dex.moves.get(moveSlot.move);\r\n\t\t\t\t\tif (move.category === 'Status') continue;\r\n\t\t\t\t\tconst moveType = move.id === 'hiddenpower' ? target.hpType : move.type;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tthis.dex.getImmunity(moveType, pokemon) && this.dex.getEffectiveness(moveType, pokemon) > 0 ||\r\n\t\t\t\t\t\tmove.ohko\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.add('-ability', pokemon, 'Anticipation');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Anticipation\",\r\n\t\trating: 0.5,\r\n\t\tnum: 107,\r\n\t},\r\n\tarenatrap: {\r\n\t\tonFoeTrapPokemon(pokemon) {\r\n\t\t\tif (!pokemon.isAdjacent(this.effectState.target)) return;\r\n\t\t\tif (pokemon.isGrounded()) {\r\n\t\t\t\tpokemon.tryTrap(true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonFoeMaybeTrapPokemon(pokemon, source) {\r\n\t\t\tif (!source) source = this.effectState.target;\r\n\t\t\tif (!source || !pokemon.isAdjacent(source)) return;\r\n\t\t\tif (pokemon.isGrounded(!pokemon.knownType)) { // Negate immunity if the type is unknown\r\n\t\t\t\tpokemon.maybeTrapped = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Arena Trap\",\r\n\t\trating: 5,\r\n\t\tnum: 71,\r\n\t},\r\n\tarmortail: {\r\n\t\tonFoeTryMove(target, source, move) {\r\n\t\t\tconst targetAllExceptions = ['perishsong', 'flowershield', 'rototiller'];\r\n\t\t\tif (move.target === 'foeSide' || (move.target === 'all' && !targetAllExceptions.includes(move.id))) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst armorTailHolder = this.effectState.target;\r\n\t\t\tif ((source.isAlly(armorTailHolder) || move.target === 'all') && move.priority > 0.1) {\r\n\t\t\t\tthis.attrLastMove('[still]');\r\n\t\t\t\tthis.add('cant', armorTailHolder, 'ability: Armor Tail', move, `[of] ${target}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Armor Tail\",\r\n\t\trating: 2.5,\r\n\t\tnum: 296,\r\n\t},\r\n\taromaveil: {\r\n\t\tonAllyTryAddVolatile(status, target, source, effect) {\r\n\t\t\tif (['attract', 'disable', 'encore', 'healblock', 'taunt', 'torment'].includes(status.id)) {\r\n\t\t\t\tif (effect.effectType === 'Move') {\r\n\t\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\t\tthis.add('-block', target, 'ability: Aroma Veil', `[of] ${effectHolder}`);\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Aroma Veil\",\r\n\t\trating: 2,\r\n\t\tnum: 165,\r\n\t},\r\n\tasoneglastrier: {\r\n\t\tonSwitchInPriority: 1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.effectState.unnerved) return;\r\n\t\t\tthis.add('-ability', pokemon, 'As One');\r\n\t\t\tthis.add('-ability', pokemon, 'Unnerve');\r\n\t\t\tthis.effectState.unnerved = true;\r\n\t\t},\r\n\t\tonEnd() {\r\n\t\t\tthis.effectState.unnerved = false;\r\n\t\t},\r\n\t\tonFoeTryEatItem() {\r\n\t\t\treturn !this.effectState.unnerved;\r\n\t\t},\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.boost({ atk: length }, source, source, this.dex.abilities.get('chillingneigh'));\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"As One (Glastrier)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 266,\r\n\t},\r\n\tasonespectrier: {\r\n\t\tonSwitchInPriority: 1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.effectState.unnerved) return;\r\n\t\t\tthis.add('-ability', pokemon, 'As One');\r\n\t\t\tthis.add('-ability', pokemon, 'Unnerve');\r\n\t\t\tthis.effectState.unnerved = true;\r\n\t\t},\r\n\t\tonEnd() {\r\n\t\t\tthis.effectState.unnerved = false;\r\n\t\t},\r\n\t\tonFoeTryEatItem() {\r\n\t\t\treturn !this.effectState.unnerved;\r\n\t\t},\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.boost({ spa: length }, source, source, this.dex.abilities.get('grimneigh'));\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"As One (Spectrier)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 267,\r\n\t},\r\n\taurabreak: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Aura Break');\r\n\t\t},\r\n\t\tonAnyTryPrimaryHit(target, source, move) {\r\n\t\t\tif (target === source || move.category === 'Status') return;\r\n\t\t\tmove.hasAuraBreak = true;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Aura Break\",\r\n\t\trating: 1,\r\n\t\tnum: 188,\r\n\t},\r\n\tbaddreams: {\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (!pokemon.hp) return;\r\n\t\t\tfor (const target of pokemon.foes()) {\r\n\t\t\t\tif (target.status === 'slp' || target.hasAbility('comatose')) {\r\n\t\t\t\t\tthis.damage(target.baseMaxhp / 8, target, pokemon);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Bad Dreams\",\r\n\t\trating: 1.5,\r\n\t\tnum: 123,\r\n\t},\r\n\tballfetch: {\r\n\t\tflags: {},\r\n\t\tname: \"Ball Fetch\",\r\n\t\trating: 0,\r\n\t\tnum: 237,\r\n\t},\r\n\tbattery: {\r\n\t\tonAllyBasePowerPriority: 22,\r\n\t\tonAllyBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (attacker !== this.effectState.target && move.category === 'Special') {\r\n\t\t\t\tthis.debug('Battery boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Battery\",\r\n\t\trating: 0,\r\n\t\tnum: 217,\r\n\t},\r\n\tbattlearmor: {\r\n\t\tonCriticalHit: false,\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Battle Armor\",\r\n\t\trating: 1,\r\n\t\tnum: 4,\r\n\t},\r\n\tbattlebond: {\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (source.bondTriggered) return;\r\n\t\t\tif (effect?.effectType !== 'Move') return;\r\n\t\t\tif (source.species.id === 'greninjabond' && source.hp && !source.transformed && source.side.foePokemonLeft()) {\r\n\t\t\t\tthis.boost({ atk: 1, spa: 1, spe: 1 }, source, source, this.effect);\r\n\t\t\t\tthis.add('-activate', source, 'ability: Battle Bond');\r\n\t\t\t\tsource.bondTriggered = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMovePriority: -1,\r\n\t\tonModifyMove(move, attacker) {\r\n\t\t\tif (move.id === 'watershuriken' && attacker.species.name === 'Greninja-Ash' &&\r\n\t\t\t\t!attacker.transformed) {\r\n\t\t\t\tmove.multihit = 3;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Battle Bond\",\r\n\t\trating: 3.5,\r\n\t\tnum: 210,\r\n\t},\r\n\tbeadsofruin: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Beads of Ruin');\r\n\t\t},\r\n\t\tonAnyModifySpD(spd, target, source, move) {\r\n\t\t\tconst abilityHolder = this.effectState.target;\r\n\t\t\tif (target.hasAbility('Beads of Ruin')) return;\r\n\t\t\tif (!move.ruinedSpD?.hasAbility('Beads of Ruin')) move.ruinedSpD = abilityHolder;\r\n\t\t\tif (move.ruinedSpD !== abilityHolder) return;\r\n\t\t\tthis.debug('Beads of Ruin SpD drop');\r\n\t\t\treturn this.chainModify(0.75);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Beads of Ruin\",\r\n\t\trating: 4.5,\r\n\t\tnum: 284,\r\n\t},\r\n\tbeastboost: {\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tconst bestStat = source.getBestStat(true, true);\r\n\t\t\t\tthis.boost({ [bestStat]: length }, source);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Beast Boost\",\r\n\t\trating: 3.5,\r\n\t\tnum: 224,\r\n\t},\r\n\tberserk: {\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (\r\n\t\t\t\teffect.effectType === \"Move\" &&\r\n\t\t\t\t!effect.multihit &&\r\n\t\t\t\t!(effect.hasSheerForce && source.hasAbility('sheerforce'))\r\n\t\t\t) {\r\n\t\t\t\tthis.effectState.checkedBerserk = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.effectState.checkedBerserk = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryEatItem(item) {\r\n\t\t\tconst healingItems = [\r\n\t\t\t\t'aguavberry', 'enigmaberry', 'figyberry', 'iapapaberry', 'magoberry', 'sitrusberry', 'wikiberry', 'oranberry', 'berryjuice',\r\n\t\t\t];\r\n\t\t\tif (healingItems.includes(item.id)) {\r\n\t\t\t\treturn this.effectState.checkedBerserk;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tonAfterMoveSecondary(target, source, move) {\r\n\t\t\tthis.effectState.checkedBerserk = true;\r\n\t\t\tif (!source || source === target || !target.hp || !move.totalDamage) return;\r\n\t\t\tconst lastAttackedBy = target.getLastAttackedBy();\r\n\t\t\tif (!lastAttackedBy) return;\r\n\t\t\tconst damage = move.multihit && !move.smartTarget ? move.totalDamage : lastAttackedBy.damage;\r\n\t\t\tif (target.hp <= target.maxhp / 2 && target.hp + damage > target.maxhp / 2) {\r\n\t\t\t\tthis.boost({ spa: 1 }, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Berserk\",\r\n\t\trating: 2,\r\n\t\tnum: 201,\r\n\t},\r\n\tbigpecks: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tif (boost.def && boost.def < 0) {\r\n\t\t\t\tdelete boost.def;\r\n\t\t\t\tif (!(effect as ActiveMove).secondaries && effect.id !== 'octolock') {\r\n\t\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"Defense\", \"[from] ability: Big Pecks\", `[of] ${target}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Big Pecks\",\r\n\t\trating: 0.5,\r\n\t\tnum: 145,\r\n\t},\r\n\tblaze: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Blaze boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Blaze boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Blaze\",\r\n\t\trating: 2,\r\n\t\tnum: 66,\r\n\t},\r\n\tbulletproof: {\r\n\t\tonTryHit(pokemon, target, move) {\r\n\t\t\tif (move.flags['bullet']) {\r\n\t\t\t\tthis.add('-immune', pokemon, '[from] ability: Bulletproof');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Bulletproof\",\r\n\t\trating: 3,\r\n\t\tnum: 171,\r\n\t},\r\n\tcheekpouch: {\r\n\t\tonEatItem(item, pokemon) {\r\n\t\t\tthis.heal(pokemon.baseMaxhp / 3);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Cheek Pouch\",\r\n\t\trating: 2,\r\n\t\tnum: 167,\r\n\t},\r\n\tchillingneigh: {\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.boost({ atk: length }, source);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Chilling Neigh\",\r\n\t\trating: 3,\r\n\t\tnum: 264,\r\n\t},\r\n\tchlorophyll: {\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Chlorophyll\",\r\n\t\trating: 3,\r\n\t\tnum: 34,\r\n\t},\r\n\tclearbody: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tlet showMsg = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tdelete boost[i];\r\n\t\t\t\t\tshowMsg = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (showMsg && !(effect as ActiveMove).secondaries && effect.id !== 'octolock') {\r\n\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"[from] ability: Clear Body\", `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Clear Body\",\r\n\t\trating: 2,\r\n\t\tnum: 29,\r\n\t},\r\n\tcloudnine: {\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\t// Cloud Nine does not activate when Skill Swapped or when Neutralizing Gas leaves the field\r\n\t\t\tthis.add('-ability', pokemon, 'Cloud Nine');\r\n\t\t\t((this.effect as any).onStart as (p: Pokemon) => void).call(this, pokemon);\r\n\t\t},\r\n\t\tonStart(pokemon) {\r\n\t\t\tpokemon.abilityState.ending = false; // Clear the ending flag\r\n\t\t\tthis.eachEvent('WeatherChange', this.effect);\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tpokemon.abilityState.ending = true;\r\n\t\t\tthis.eachEvent('WeatherChange', this.effect);\r\n\t\t},\r\n\t\tsuppressWeather: true,\r\n\t\tflags: {},\r\n\t\tname: \"Cloud Nine\",\r\n\t\trating: 1.5,\r\n\t\tnum: 13,\r\n\t},\r\n\tcolorchange: {\r\n\t\tonAfterMoveSecondary(target, source, move) {\r\n\t\t\tif (!target.hp) return;\r\n\t\t\tconst type = move.type;\r\n\t\t\tif (\r\n\t\t\t\ttarget.isActive && move.effectType === 'Move' && move.category !== 'Status' &&\r\n\t\t\t\ttype !== '???' && !target.hasType(type)\r\n\t\t\t) {\r\n\t\t\t\tif (!target.setType(type)) return false;\r\n\t\t\t\tthis.add('-start', target, 'typechange', type, '[from] ability: Color Change');\r\n\r\n\t\t\t\tif (target.side.active.length === 2 && target.position === 1) {\r\n\t\t\t\t\t// Curse Glitch\r\n\t\t\t\t\tconst action = this.queue.willMove(target);\r\n\t\t\t\t\tif (action && action.move.id === 'curse') {\r\n\t\t\t\t\t\taction.targetLoc = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Color Change\",\r\n\t\trating: 0,\r\n\t\tnum: 16,\r\n\t},\r\n\tcomatose: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Comatose');\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Comatose');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t// Permanent sleep \"status\" implemented in the relevant sleep-checking effects\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Comatose\",\r\n\t\trating: 4,\r\n\t\tnum: 213,\r\n\t},\r\n\tcommander: {\r\n\t\tonAnySwitchInPriority: -2,\r\n\t\tonAnySwitchIn() {\r\n\t\t\t((this.effect as any).onUpdate as (p: Pokemon) => void).call(this, this.effectState.target);\r\n\t\t},\r\n\t\tonStart(pokemon) {\r\n\t\t\t((this.effect as any).onUpdate as (p: Pokemon) => void).call(this, pokemon);\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (this.gameType !== 'doubles') return;\r\n\t\t\t// don't run between when a Pokemon switches in and the resulting onSwitchIn event\r\n\t\t\tif (this.queue.peek()?.choice === 'runSwitch') return;\r\n\r\n\t\t\tconst ally = pokemon.allies()[0];\r\n\t\t\tif (pokemon.switchFlag || ally?.switchFlag) return;\r\n\t\t\tif (!ally || pokemon.baseSpecies.baseSpecies !== 'Tatsugiri' || ally.baseSpecies.baseSpecies !== 'Dondozo') {\r\n\t\t\t\t// Handle any edge cases\r\n\t\t\t\tif (pokemon.getVolatile('commanding')) pokemon.removeVolatile('commanding');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!pokemon.getVolatile('commanding')) {\r\n\t\t\t\t// If Dondozo already was commanded this fails\r\n\t\t\t\tif (ally.getVolatile('commanded')) return;\r\n\t\t\t\t// Cancel all actions this turn for pokemon if applicable\r\n\t\t\t\tthis.queue.cancelAction(pokemon);\r\n\t\t\t\t// Add volatiles to both pokemon\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Commander', `[of] ${ally}`);\r\n\t\t\t\tpokemon.addVolatile('commanding');\r\n\t\t\t\tally.addVolatile('commanded', pokemon);\r\n\t\t\t\t// Continued in conditions.ts in the volatiles\r\n\t\t\t} else {\r\n\t\t\t\tif (!ally.fainted) return;\r\n\t\t\t\tpokemon.removeVolatile('commanding');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1 },\r\n\t\tname: \"Commander\",\r\n\t\trating: 0,\r\n\t\tnum: 279,\r\n\t},\r\n\tcompetitive: {\r\n\t\tonAfterEachBoost(boost, target, source, effect) {\r\n\t\t\tif (!source || target.isAlly(source)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet statsLowered = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tstatsLowered = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (statsLowered) {\r\n\t\t\t\tthis.boost({ spa: 2 }, target, target, null, false, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Competitive\",\r\n\t\trating: 2.5,\r\n\t\tnum: 172,\r\n\t},\r\n\tcompoundeyes: {\r\n\t\tonSourceModifyAccuracyPriority: -1,\r\n\t\tonSourceModifyAccuracy(accuracy) {\r\n\t\t\tif (typeof accuracy !== 'number') return;\r\n\t\t\tthis.debug('compoundeyes - enhancing accuracy');\r\n\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Compound Eyes\",\r\n\t\trating: 3,\r\n\t\tnum: 14,\r\n\t},\r\n\tcontrary: {\r\n\t\tonChangeBoost(boost, target, source, effect) {\r\n\t\t\tif (effect && effect.id === 'zpower') return;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tboost[i]! *= -1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Contrary\",\r\n\t\trating: 4.5,\r\n\t\tnum: 126,\r\n\t},\r\n\tcorrosion: {\r\n\t\t// Implemented in sim/pokemon.js:Pokemon#setStatus\r\n\t\tflags: {},\r\n\t\tname: \"Corrosion\",\r\n\t\trating: 2.5,\r\n\t\tnum: 212,\r\n\t},\r\n\tcostar: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tconst ally = pokemon.allies()[0];\r\n\t\t\tif (!ally) return;\r\n\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in ally.boosts) {\r\n\t\t\t\tpokemon.boosts[i] = ally.boosts[i];\r\n\t\t\t}\r\n\t\t\tconst volatilesToCopy = ['dragoncheer', 'focusenergy', 'gmaxchistrike', 'laserfocus'];\r\n\t\t\t// we need to be sure to remove all the overlapping crit volatiles before trying to add any\r\n\t\t\tfor (const volatile of volatilesToCopy) pokemon.removeVolatile(volatile);\r\n\t\t\tfor (const volatile of volatilesToCopy) {\r\n\t\t\t\tif (ally.volatiles[volatile]) {\r\n\t\t\t\t\tpokemon.addVolatile(volatile);\r\n\t\t\t\t\tif (volatile === 'gmaxchistrike') pokemon.volatiles[volatile].layers = ally.volatiles[volatile].layers;\r\n\t\t\t\t\tif (volatile === 'dragoncheer') pokemon.volatiles[volatile].hasDragonType = ally.volatiles[volatile].hasDragonType;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.add('-copyboost', pokemon, ally, '[from] ability: Costar');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Costar\",\r\n\t\trating: 0,\r\n\t\tnum: 294,\r\n\t},\r\n\tcottondown: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tlet activated = false;\r\n\t\t\tfor (const pokemon of this.getAllActive()) {\r\n\t\t\t\tif (pokemon === target || pokemon.fainted) continue;\r\n\t\t\t\tif (!activated) {\r\n\t\t\t\t\tthis.add('-ability', target, 'Cotton Down');\r\n\t\t\t\t\tactivated = true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.boost({ spe: -1 }, pokemon, target, null, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Cotton Down\",\r\n\t\trating: 2,\r\n\t\tnum: 238,\r\n\t},\r\n\tcudchew: {\r\n\t\tonEatItem(item, pokemon, source, effect) {\r\n\t\t\tif (item.isBerry && (!effect || !['bugbite', 'pluck'].includes(effect.id))) {\r\n\t\t\t\tthis.effectState.berry = item;\r\n\t\t\t\tthis.effectState.counter = 2;\r\n\t\t\t\t// This is needed in case the berry was eaten during residuals, preventing the timer from decreasing this turn\r\n\t\t\t\tif (!this.queue.peek()) this.effectState.counter--;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (!this.effectState.berry || !pokemon.hp) return;\r\n\t\t\tif (--this.effectState.counter <= 0) {\r\n\t\t\t\tconst item = this.effectState.berry;\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Cud Chew');\r\n\t\t\t\tthis.add('-enditem', pokemon, item.name, '[eat]');\r\n\t\t\t\tif (this.singleEvent('Eat', item, null, pokemon, null, null)) {\r\n\t\t\t\t\tthis.runEvent('EatItem', pokemon, null, null, item);\r\n\t\t\t\t}\r\n\t\t\t\tif (item.onEat) pokemon.ateBerry = true;\r\n\t\t\t\tdelete this.effectState.berry;\r\n\t\t\t\tdelete this.effectState.counter;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Cud Chew\",\r\n\t\trating: 2,\r\n\t\tnum: 291,\r\n\t},\r\n\tcuriousmedicine: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tfor (const ally of pokemon.adjacentAllies()) {\r\n\t\t\t\tally.clearBoosts();\r\n\t\t\t\tthis.add('-clearboost', ally, '[from] ability: Curious Medicine', `[of] ${pokemon}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Curious Medicine\",\r\n\t\trating: 0,\r\n\t\tnum: 261,\r\n\t},\r\n\tcursedbody: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (source.volatiles['disable']) return;\r\n\t\t\tif (!move.isMax && !move.flags['futuremove'] && move.id !== 'struggle') {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\tsource.addVolatile('disable', this.effectState.target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Cursed Body\",\r\n\t\trating: 2,\r\n\t\tnum: 130,\r\n\t},\r\n\tcutecharm: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target)) {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\tsource.addVolatile('attract', this.effectState.target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Cute Charm\",\r\n\t\trating: 0.5,\r\n\t\tnum: 56,\r\n\t},\r\n\tdamp: {\r\n\t\tonAnyTryMove(target, source, effect) {\r\n\t\t\tif (['explosion', 'mindblown', 'mistyexplosion', 'selfdestruct'].includes(effect.id)) {\r\n\t\t\t\tthis.attrLastMove('[still]');\r\n\t\t\t\tthis.add('cant', this.effectState.target, 'ability: Damp', effect, `[of] ${target}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAnyDamage(damage, target, source, effect) {\r\n\t\t\tif (effect && effect.name === 'Aftermath') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Damp\",\r\n\t\trating: 0.5,\r\n\t\tnum: 6,\r\n\t},\r\n\tdancer: {\r\n\t\tflags: {},\r\n\t\tname: \"Dancer\",\r\n\t\t// implemented in runMove in scripts.js\r\n\t\trating: 1.5,\r\n\t\tnum: 216,\r\n\t},\r\n\tdarkaura: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Dark Aura');\r\n\t\t},\r\n\t\tonAnyBasePowerPriority: 20,\r\n\t\tonAnyBasePower(basePower, source, target, move) {\r\n\t\t\tif (target === source || move.category === 'Status' || move.type !== 'Dark') return;\r\n\t\t\tif (!move.auraBooster?.hasAbility('Dark Aura')) move.auraBooster = this.effectState.target;\r\n\t\t\tif (move.auraBooster !== this.effectState.target) return;\r\n\t\t\treturn this.chainModify([move.hasAuraBreak ? 3072 : 5448, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Dark Aura\",\r\n\t\trating: 3,\r\n\t\tnum: 186,\r\n\t},\r\n\tdauntlessshield: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.shieldBoost) return;\r\n\t\t\tpokemon.shieldBoost = true;\r\n\t\t\tthis.boost({ def: 1 }, pokemon);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Dauntless Shield\",\r\n\t\trating: 3.5,\r\n\t\tnum: 235,\r\n\t},\r\n\tdazzling: {\r\n\t\tonFoeTryMove(target, source, move) {\r\n\t\t\tconst targetAllExceptions = ['perishsong', 'flowershield', 'rototiller'];\r\n\t\t\tif (move.target === 'foeSide' || (move.target === 'all' && !targetAllExceptions.includes(move.id))) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst dazzlingHolder = this.effectState.target;\r\n\t\t\tif ((source.isAlly(dazzlingHolder) || move.target === 'all') && move.priority > 0.1) {\r\n\t\t\t\tthis.attrLastMove('[still]');\r\n\t\t\t\tthis.add('cant', dazzlingHolder, 'ability: Dazzling', move, `[of] ${target}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Dazzling\",\r\n\t\trating: 2.5,\r\n\t\tnum: 219,\r\n\t},\r\n\tdefeatist: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\tif (pokemon.hp <= pokemon.maxhp / 2) {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, pokemon) {\r\n\t\t\tif (pokemon.hp <= pokemon.maxhp / 2) {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Defeatist\",\r\n\t\trating: -1,\r\n\t\tnum: 129,\r\n\t},\r\n\tdefiant: {\r\n\t\tonAfterEachBoost(boost, target, source, effect) {\r\n\t\t\tif (!source || target.isAlly(source)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet statsLowered = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tstatsLowered = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (statsLowered) {\r\n\t\t\t\tthis.boost({ atk: 2 }, target, target, null, false, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Defiant\",\r\n\t\trating: 3,\r\n\t\tnum: 128,\r\n\t},\r\n\tdeltastream: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setWeather('deltastream');\r\n\t\t},\r\n\t\tonAnySetWeather(target, source, weather) {\r\n\t\t\tconst strongWeathers = ['desolateland', 'primordialsea', 'deltastream'];\r\n\t\t\tif (this.field.getWeather().id === 'deltastream' && !strongWeathers.includes(weather.id)) return false;\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tif (this.field.weatherState.source !== pokemon) return;\r\n\t\t\tfor (const target of this.getAllActive()) {\r\n\t\t\t\tif (target === pokemon) continue;\r\n\t\t\t\tif (target.hasAbility('deltastream')) {\r\n\t\t\t\t\tthis.field.weatherState.source = target;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.field.clearWeather();\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Delta Stream\",\r\n\t\trating: 4,\r\n\t\tnum: 191,\r\n\t},\r\n\tdesolateland: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setWeather('desolateland');\r\n\t\t},\r\n\t\tonAnySetWeather(target, source, weather) {\r\n\t\t\tconst strongWeathers = ['desolateland', 'primordialsea', 'deltastream'];\r\n\t\t\tif (this.field.getWeather().id === 'desolateland' && !strongWeathers.includes(weather.id)) return false;\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tif (this.field.weatherState.source !== pokemon) return;\r\n\t\t\tfor (const target of this.getAllActive()) {\r\n\t\t\t\tif (target === pokemon) continue;\r\n\t\t\t\tif (target.hasAbility('desolateland')) {\r\n\t\t\t\t\tthis.field.weatherState.source = target;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.field.clearWeather();\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Desolate Land\",\r\n\t\trating: 4.5,\r\n\t\tnum: 190,\r\n\t},\r\n\tdisguise: {\r\n\t\tonDamagePriority: 1,\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect?.effectType === 'Move' && ['mimikyu', 'mimikyutotem'].includes(target.species.id)) {\r\n\t\t\t\tthis.add('-activate', target, 'ability: Disguise');\r\n\t\t\t\tthis.effectState.busted = true;\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonCriticalHit(target, source, move) {\r\n\t\t\tif (!target) return;\r\n\t\t\tif (!['mimikyu', 'mimikyutotem'].includes(target.species.id)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst hitSub = target.volatiles['substitute'] && !move.flags['bypasssub'] && !(move.infiltrates && this.gen >= 6);\r\n\t\t\tif (hitSub) return;\r\n\r\n\t\t\tif (!target.runImmunity(move)) return;\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonEffectiveness(typeMod, target, type, move) {\r\n\t\t\tif (!target || move.category === 'Status') return;\r\n\t\t\tif (!['mimikyu', 'mimikyutotem'].includes(target.species.id)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst hitSub = target.volatiles['substitute'] && !move.flags['bypasssub'] && !(move.infiltrates && this.gen >= 6);\r\n\t\t\tif (hitSub) return;\r\n\r\n\t\t\tif (!target.runImmunity(move)) return;\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (['mimikyu', 'mimikyutotem'].includes(pokemon.species.id) && this.effectState.busted) {\r\n\t\t\t\tconst speciesid = pokemon.species.id === 'mimikyutotem' ? 'Mimikyu-Busted-Totem' : 'Mimikyu-Busted';\r\n\t\t\t\tpokemon.formeChange(speciesid, this.effect, true);\r\n\t\t\t\tthis.damage(pokemon.baseMaxhp / 8, pokemon, pokemon, this.dex.species.get(speciesid));\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {\r\n\t\t\tfailroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1,\r\n\t\t\tbreakable: 1, notransform: 1,\r\n\t\t},\r\n\t\tname: \"Disguise\",\r\n\t\trating: 3.5,\r\n\t\tnum: 209,\r\n\t},\r\n\tdownload: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tlet totaldef = 0;\r\n\t\t\tlet totalspd = 0;\r\n\t\t\tfor (const target of pokemon.foes()) {\r\n\t\t\t\ttotaldef += target.getStat('def', false, true);\r\n\t\t\t\ttotalspd += target.getStat('spd', false, true);\r\n\t\t\t}\r\n\t\t\tif (totaldef && totaldef >= totalspd) {\r\n\t\t\t\tthis.boost({ spa: 1 });\r\n\t\t\t} else if (totalspd) {\r\n\t\t\t\tthis.boost({ atk: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Download\",\r\n\t\trating: 3.5,\r\n\t\tnum: 88,\r\n\t},\r\n\tdragonsmaw: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Dragon') {\r\n\t\t\t\tthis.debug('Dragon\\'s Maw boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Dragon') {\r\n\t\t\t\tthis.debug('Dragon\\'s Maw boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Dragon's Maw\",\r\n\t\trating: 3.5,\r\n\t\tnum: 263,\r\n\t},\r\n\tdrizzle: {\r\n\t\tonStart(source) {\r\n\t\t\tif (source.species.id === 'kyogre' && source.item === 'blueorb') return;\r\n\t\t\tthis.field.setWeather('raindance');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Drizzle\",\r\n\t\trating: 4,\r\n\t\tnum: 2,\r\n\t},\r\n\tdrought: {\r\n\t\tonStart(source) {\r\n\t\t\tif (source.species.id === 'groudon' && source.item === 'redorb') return;\r\n\t\t\tthis.field.setWeather('sunnyday');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Drought\",\r\n\t\trating: 4,\r\n\t\tnum: 70,\r\n\t},\r\n\tdryskin: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Water') {\r\n\t\t\t\tif (!this.heal(target.baseMaxhp / 4)) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Dry Skin');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceBasePowerPriority: 17,\r\n\t\tonSourceBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\treturn this.chainModify(1.25);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonWeather(target, source, effect) {\r\n\t\t\tif (target.hasItem('utilityumbrella')) return;\r\n\t\t\tif (effect.id === 'raindance' || effect.id === 'primordialsea') {\r\n\t\t\t\tthis.heal(target.baseMaxhp / 8);\r\n\t\t\t} else if (effect.id === 'sunnyday' || effect.id === 'desolateland') {\r\n\t\t\t\tthis.damage(target.baseMaxhp / 8, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Dry Skin\",\r\n\t\trating: 3,\r\n\t\tnum: 87,\r\n\t},\r\n\tearlybird: {\r\n\t\tflags: {},\r\n\t\tname: \"Early Bird\",\r\n\t\t// Implemented in statuses.js\r\n\t\trating: 1.5,\r\n\t\tnum: 48,\r\n\t},\r\n\teartheater: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Ground') {\r\n\t\t\t\tif (!this.heal(target.baseMaxhp / 4)) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Earth Eater');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Earth Eater\",\r\n\t\trating: 3.5,\r\n\t\tnum: 297,\r\n\t},\r\n\teffectspore: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target) && !source.status && source.runStatusImmunity('powder')) {\r\n\t\t\t\tconst r = this.random(100);\r\n\t\t\t\tif (r < 11) {\r\n\t\t\t\t\tsource.setStatus('slp', target);\r\n\t\t\t\t} else if (r < 21) {\r\n\t\t\t\t\tsource.setStatus('par', target);\r\n\t\t\t\t} else if (r < 30) {\r\n\t\t\t\t\tsource.setStatus('psn', target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Effect Spore\",\r\n\t\trating: 2,\r\n\t\tnum: 27,\r\n\t},\r\n\telectricsurge: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setTerrain('electricterrain');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Electric Surge\",\r\n\t\trating: 4,\r\n\t\tnum: 226,\r\n\t},\r\n\telectromorphosis: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\ttarget.addVolatile('charge');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Electromorphosis\",\r\n\t\trating: 3,\r\n\t\tnum: 280,\r\n\t},\r\n\tembodyaspectcornerstone: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.name === 'Ogerpon-Cornerstone-Tera' && pokemon.terastallized &&\r\n\t\t\t\t!this.effectState.embodied) {\r\n\t\t\t\tthis.effectState.embodied = true;\r\n\t\t\t\tthis.boost({ def: 1 }, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Embody Aspect (Cornerstone)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 304,\r\n\t},\r\n\tembodyaspecthearthflame: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.name === 'Ogerpon-Hearthflame-Tera' && pokemon.terastallized &&\r\n\t\t\t\t!this.effectState.embodied) {\r\n\t\t\t\tthis.effectState.embodied = true;\r\n\t\t\t\tthis.boost({ atk: 1 }, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Embody Aspect (Hearthflame)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 303,\r\n\t},\r\n\tembodyaspectteal: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.name === 'Ogerpon-Teal-Tera' && pokemon.terastallized &&\r\n\t\t\t\t!this.effectState.embodied) {\r\n\t\t\t\tthis.effectState.embodied = true;\r\n\t\t\t\tthis.boost({ spe: 1 }, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Embody Aspect (Teal)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 301,\r\n\t},\r\n\tembodyaspectwellspring: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.name === 'Ogerpon-Wellspring-Tera' && pokemon.terastallized &&\r\n\t\t\t\t!this.effectState.embodied) {\r\n\t\t\t\tthis.effectState.embodied = true;\r\n\t\t\t\tthis.boost({ spd: 1 }, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Embody Aspect (Wellspring)\",\r\n\t\trating: 3.5,\r\n\t\tnum: 302,\r\n\t},\r\n\temergencyexit: {\r\n\t\tonEmergencyExit(target) {\r\n\t\t\tif (!this.canSwitch(target.side) || target.forceSwitchFlag || target.switchFlag) return;\r\n\t\t\tfor (const side of this.sides) {\r\n\t\t\t\tfor (const active of side.active) {\r\n\t\t\t\t\tactive.switchFlag = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttarget.switchFlag = true;\r\n\t\t\tthis.add('-activate', target, 'ability: Emergency Exit');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Emergency Exit\",\r\n\t\trating: 1,\r\n\t\tnum: 194,\r\n\t},\r\n\tfairyaura: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Fairy Aura');\r\n\t\t},\r\n\t\tonAnyBasePowerPriority: 20,\r\n\t\tonAnyBasePower(basePower, source, target, move) {\r\n\t\t\tif (target === source || move.category === 'Status' || move.type !== 'Fairy') return;\r\n\t\t\tif (!move.auraBooster?.hasAbility('Fairy Aura')) move.auraBooster = this.effectState.target;\r\n\t\t\tif (move.auraBooster !== this.effectState.target) return;\r\n\t\t\treturn this.chainModify([move.hasAuraBreak ? 3072 : 5448, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Fairy Aura\",\r\n\t\trating: 3,\r\n\t\tnum: 187,\r\n\t},\r\n\tfilter: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.getMoveHitData(move).typeMod > 0) {\r\n\t\t\t\tthis.debug('Filter neutralize');\r\n\t\t\t\treturn this.chainModify(0.75);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Filter\",\r\n\t\trating: 3,\r\n\t\tnum: 111,\r\n\t},\r\n\tflamebody: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target)) {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\tsource.trySetStatus('brn', target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Flame Body\",\r\n\t\trating: 2,\r\n\t\tnum: 49,\r\n\t},\r\n\tflareboost: {\r\n\t\tonBasePowerPriority: 19,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (attacker.status === 'brn' && move.category === 'Special') {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Flare Boost\",\r\n\t\trating: 2,\r\n\t\tnum: 138,\r\n\t},\r\n\tflashfire: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Fire') {\r\n\t\t\t\tmove.accuracy = true;\r\n\t\t\t\tif (!target.addVolatile('flashfire')) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Flash Fire');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tpokemon.removeVolatile('flashfire');\r\n\t\t},\r\n\t\tcondition: {\r\n\t\t\tnoCopy: true, // doesn't get copied by Baton Pass\r\n\t\t\tonStart(target) {\r\n\t\t\t\tthis.add('-start', target, 'ability: Flash Fire');\r\n\t\t\t},\r\n\t\t\tonModifyAtkPriority: 5,\r\n\t\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\t\tif (move.type === 'Fire' && attacker.hasAbility('flashfire')) {\r\n\t\t\t\t\tthis.debug('Flash Fire boost');\r\n\t\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonModifySpAPriority: 5,\r\n\t\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\t\tif (move.type === 'Fire' && attacker.hasAbility('flashfire')) {\r\n\t\t\t\t\tthis.debug('Flash Fire boost');\r\n\t\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonEnd(target) {\r\n\t\t\t\tthis.add('-end', target, 'ability: Flash Fire', '[silent]');\r\n\t\t\t},\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Flash Fire\",\r\n\t\trating: 3.5,\r\n\t\tnum: 18,\r\n\t},\r\n\tflowergift: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('WeatherChange', this.effect, this.effectState, pokemon);\r\n\t\t},\r\n\t\tonWeatherChange(pokemon) {\r\n\t\t\tif (!pokemon.isActive || pokemon.baseSpecies.baseSpecies !== 'Cherrim' || pokemon.transformed) return;\r\n\t\t\tif (!pokemon.hp) return;\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\tif (pokemon.species.id !== 'cherrimsunshine') {\r\n\t\t\t\t\tpokemon.formeChange('Cherrim-Sunshine', this.effect, false, '0', '[msg]');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (pokemon.species.id === 'cherrimsunshine') {\r\n\t\t\t\t\tpokemon.formeChange('Cherrim', this.effect, false, '0', '[msg]');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyModifyAtkPriority: 3,\r\n\t\tonAllyModifyAtk(atk, pokemon) {\r\n\t\t\tif (this.effectState.target.baseSpecies.baseSpecies !== 'Cherrim') return;\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyModifySpDPriority: 4,\r\n\t\tonAllyModifySpD(spd, pokemon) {\r\n\t\t\tif (this.effectState.target.baseSpecies.baseSpecies !== 'Cherrim') return;\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, breakable: 1 },\r\n\t\tname: \"Flower Gift\",\r\n\t\trating: 1,\r\n\t\tnum: 122,\r\n\t},\r\n\tflowerveil: {\r\n\t\tonAllyTryBoost(boost, target, source, effect) {\r\n\t\t\tif ((source && target === source) || !target.hasType('Grass')) return;\r\n\t\t\tlet showMsg = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tdelete boost[i];\r\n\t\t\t\t\tshowMsg = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (showMsg && !(effect as ActiveMove).secondaries) {\r\n\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\tthis.add('-block', target, 'ability: Flower Veil', `[of] ${effectHolder}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllySetStatus(status, target, source, effect) {\r\n\t\t\tif (target.hasType('Grass') && source && target !== source && effect && effect.id !== 'yawn') {\r\n\t\t\t\tthis.debug('interrupting setStatus with Flower Veil');\r\n\t\t\t\tif (effect.name === 'Synchronize' || (effect.effectType === 'Move' && !effect.secondaries)) {\r\n\t\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\t\tthis.add('-block', target, 'ability: Flower Veil', `[of] ${effectHolder}`);\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyTryAddVolatile(status, target) {\r\n\t\t\tif (target.hasType('Grass') && status.id === 'yawn') {\r\n\t\t\t\tthis.debug('Flower Veil blocking yawn');\r\n\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\tthis.add('-block', target, 'ability: Flower Veil', `[of] ${effectHolder}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Flower Veil\",\r\n\t\trating: 0,\r\n\t\tnum: 166,\r\n\t},\r\n\tfluffy: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tlet mod = 1;\r\n\t\t\tif (move.type === 'Fire') mod *= 2;\r\n\t\t\tif (move.flags['contact']) mod /= 2;\r\n\t\t\treturn this.chainModify(mod);\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Fluffy\",\r\n\t\trating: 3.5,\r\n\t\tnum: 218,\r\n\t},\r\n\tforecast: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('WeatherChange', this.effect, this.effectState, pokemon);\r\n\t\t},\r\n\t\tonWeatherChange(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Castform' || pokemon.transformed) return;\r\n\t\t\tlet forme = null;\r\n\t\t\tswitch (pokemon.effectiveWeather()) {\r\n\t\t\tcase 'sunnyday':\r\n\t\t\tcase 'desolateland':\r\n\t\t\t\tif (pokemon.species.id !== 'castformsunny') forme = 'Castform-Sunny';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'raindance':\r\n\t\t\tcase 'primordialsea':\r\n\t\t\t\tif (pokemon.species.id !== 'castformrainy') forme = 'Castform-Rainy';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'hail':\r\n\t\t\tcase 'snowscape':\r\n\t\t\t\tif (pokemon.species.id !== 'castformsnowy') forme = 'Castform-Snowy';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (pokemon.species.id !== 'castform') forme = 'Castform';\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (pokemon.isActive && forme) {\r\n\t\t\t\tpokemon.formeChange(forme, this.effect, false, '0', '[msg]');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1 },\r\n\t\tname: \"Forecast\",\r\n\t\trating: 2,\r\n\t\tnum: 59,\r\n\t},\r\n\tforewarn: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tlet warnMoves: (Move | Pokemon)[][] = [];\r\n\t\t\tlet warnBp = 1;\r\n\t\t\tfor (const target of pokemon.foes()) {\r\n\t\t\t\tfor (const moveSlot of target.moveSlots) {\r\n\t\t\t\t\tconst move = this.dex.moves.get(moveSlot.move);\r\n\t\t\t\t\tlet bp = move.basePower;\r\n\t\t\t\t\tif (move.ohko) bp = 150;\r\n\t\t\t\t\tif (move.id === 'counter' || move.id === 'metalburst' || move.id === 'mirrorcoat') bp = 120;\r\n\t\t\t\t\tif (bp === 1) bp = 80;\r\n\t\t\t\t\tif (!bp && move.category !== 'Status') bp = 80;\r\n\t\t\t\t\tif (bp > warnBp) {\r\n\t\t\t\t\t\twarnMoves = [[move, target]];\r\n\t\t\t\t\t\twarnBp = bp;\r\n\t\t\t\t\t} else if (bp === warnBp) {\r\n\t\t\t\t\t\twarnMoves.push([move, target]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!warnMoves.length) return;\r\n\t\t\tconst [warnMoveName, warnTarget] = this.sample(warnMoves);\r\n\t\t\tthis.add('-activate', pokemon, 'ability: Forewarn', warnMoveName, `[of] ${warnTarget}`);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Forewarn\",\r\n\t\trating: 0.5,\r\n\t\tnum: 108,\r\n\t},\r\n\tfriendguard: {\r\n\t\tonAnyModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target !== this.effectState.target && target.isAlly(this.effectState.target)) {\r\n\t\t\t\tthis.debug('Friend Guard weaken');\r\n\t\t\t\treturn this.chainModify(0.75);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Friend Guard\",\r\n\t\trating: 0,\r\n\t\tnum: 132,\r\n\t},\r\n\tfrisk: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tfor (const target of pokemon.foes()) {\r\n\t\t\t\tif (target.item) {\r\n\t\t\t\t\tthis.add('-item', target, target.getItem().name, '[from] ability: Frisk', `[of] ${pokemon}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Frisk\",\r\n\t\trating: 1.5,\r\n\t\tnum: 119,\r\n\t},\r\n\tfullmetalbody: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tlet showMsg = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tdelete boost[i];\r\n\t\t\t\t\tshowMsg = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (showMsg && !(effect as ActiveMove).secondaries && effect.id !== 'octolock') {\r\n\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"[from] ability: Full Metal Body\", `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Full Metal Body\",\r\n\t\trating: 2,\r\n\t\tnum: 230,\r\n\t},\r\n\tfurcoat: {\r\n\t\tonModifyDefPriority: 6,\r\n\t\tonModifyDef(def) {\r\n\t\t\treturn this.chainModify(2);\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Fur Coat\",\r\n\t\trating: 4,\r\n\t\tnum: 169,\r\n\t},\r\n\tgalewings: {\r\n\t\tonModifyPriority(priority, pokemon, target, move) {\r\n\t\t\tif (move?.type === 'Flying' && pokemon.hp === pokemon.maxhp) return priority + 1;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Gale Wings\",\r\n\t\trating: 1.5,\r\n\t\tnum: 177,\r\n\t},\r\n\tgalvanize: {\r\n\t\tonModifyTypePriority: -1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tconst noModifyType = [\r\n\t\t\t\t'judgment', 'multiattack', 'naturalgift', 'revelationdance', 'technoblast', 'terrainpulse', 'weatherball',\r\n\t\t\t];\r\n\t\t\tif (move.type === 'Normal' && (!noModifyType.includes(move.id) || this.activeMove?.isMax) &&\r\n\t\t\t\t!(move.isZ && move.category !== 'Status') && !(move.name === 'Tera Blast' && pokemon.terastallized)) {\r\n\t\t\t\tmove.type = 'Electric';\r\n\t\t\t\tmove.typeChangerBoosted = this.effect;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.typeChangerBoosted === this.effect) return this.chainModify([4915, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Galvanize\",\r\n\t\trating: 4,\r\n\t\tnum: 206,\r\n\t},\r\n\tgluttony: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tpokemon.abilityState.gluttony = true;\r\n\t\t},\r\n\t\tonDamage(item, pokemon) {\r\n\t\t\tpokemon.abilityState.gluttony = true;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Gluttony\",\r\n\t\trating: 1.5,\r\n\t\tnum: 82,\r\n\t},\r\n\tgoodasgold: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (move.category === 'Status' && target !== source) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Good as Gold');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Good as Gold\",\r\n\t\trating: 5,\r\n\t\tnum: 283,\r\n\t},\r\n\tgooey: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, true)) {\r\n\t\t\t\tthis.add('-ability', target, 'Gooey');\r\n\t\t\t\tthis.boost({ spe: -1 }, source, target, null, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Gooey\",\r\n\t\trating: 2,\r\n\t\tnum: 183,\r\n\t},\r\n\tgorillatactics: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tpokemon.abilityState.choiceLock = \"\";\r\n\t\t},\r\n\t\tonBeforeMove(pokemon, target, move) {\r\n\t\t\tif (move.isZOrMaxPowered || move.id === 'struggle') return;\r\n\t\t\tif (pokemon.abilityState.choiceLock && pokemon.abilityState.choiceLock !== move.id) {\r\n\t\t\t\t// Fails unless ability is being ignored (these events will not run), no PP lost.\r\n\t\t\t\tthis.addMove('move', pokemon, move.name);\r\n\t\t\t\tthis.attrLastMove('[still]');\r\n\t\t\t\tthis.debug(\"Disabled by Gorilla Tactics\");\r\n\t\t\t\tthis.add('-fail', pokemon);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMove(move, pokemon) {\r\n\t\t\tif (pokemon.abilityState.choiceLock || move.isZOrMaxPowered || move.id === 'struggle') return;\r\n\t\t\tpokemon.abilityState.choiceLock = move.id;\r\n\t\t},\r\n\t\tonModifyAtkPriority: 1,\r\n\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\tif (pokemon.volatiles['dynamax']) return;\r\n\t\t\t// PLACEHOLDER\r\n\t\t\tthis.debug('Gorilla Tactics Atk Boost');\r\n\t\t\treturn this.chainModify(1.5);\r\n\t\t},\r\n\t\tonDisableMove(pokemon) {\r\n\t\t\tif (!pokemon.abilityState.choiceLock) return;\r\n\t\t\tif (pokemon.volatiles['dynamax']) return;\r\n\t\t\tfor (const moveSlot of pokemon.moveSlots) {\r\n\t\t\t\tif (moveSlot.id !== pokemon.abilityState.choiceLock) {\r\n\t\t\t\t\tpokemon.disableMove(moveSlot.id, false, this.effectState.sourceEffect);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tpokemon.abilityState.choiceLock = \"\";\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Gorilla Tactics\",\r\n\t\trating: 4.5,\r\n\t\tnum: 255,\r\n\t},\r\n\tgrasspelt: {\r\n\t\tonModifyDefPriority: 6,\r\n\t\tonModifyDef(pokemon) {\r\n\t\t\tif (this.field.isTerrain('grassyterrain')) return this.chainModify(1.5);\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Grass Pelt\",\r\n\t\trating: 0.5,\r\n\t\tnum: 179,\r\n\t},\r\n\tgrassysurge: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setTerrain('grassyterrain');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Grassy Surge\",\r\n\t\trating: 4,\r\n\t\tnum: 229,\r\n\t},\r\n\tgrimneigh: {\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.boost({ spa: length }, source);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Grim Neigh\",\r\n\t\trating: 3,\r\n\t\tnum: 265,\r\n\t},\r\n\tguarddog: {\r\n\t\tonDragOutPriority: 1,\r\n\t\tonDragOut(pokemon) {\r\n\t\t\tthis.add('-activate', pokemon, 'ability: Guard Dog');\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tonTryBoostPriority: 2,\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (effect.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tthis.boost({ atk: 1 }, target, target, null, false, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Guard Dog\",\r\n\t\trating: 2,\r\n\t\tnum: 275,\r\n\t},\r\n\tgulpmissile: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (!source.hp || !source.isActive || target.isSemiInvulnerable()) return;\r\n\t\t\tif (['cramorantgulping', 'cramorantgorging'].includes(target.species.id)) {\r\n\t\t\t\tthis.damage(source.baseMaxhp / 4, source, target);\r\n\t\t\t\tif (target.species.id === 'cramorantgulping') {\r\n\t\t\t\t\tthis.boost({ def: -1 }, source, target, null, true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsource.trySetStatus('par', target, move);\r\n\t\t\t\t}\r\n\t\t\t\ttarget.formeChange('cramorant', move);\r\n\t\t\t}\r\n\t\t},\r\n\t\t// The Dive part of this mechanic is implemented in Dive's `onTryMove` in moves.ts\r\n\t\tonSourceTryPrimaryHit(target, source, effect) {\r\n\t\t\tif (effect?.id === 'surf' && source.hasAbility('gulpmissile') && source.species.name === 'Cramorant') {\r\n\t\t\t\tconst forme = source.hp <= source.maxhp / 2 ? 'cramorantgorging' : 'cramorantgulping';\r\n\t\t\t\tsource.formeChange(forme, effect);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { cantsuppress: 1, notransform: 1 },\r\n\t\tname: \"Gulp Missile\",\r\n\t\trating: 2.5,\r\n\t\tnum: 241,\r\n\t},\r\n\tguts: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\tif (pokemon.status) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Guts\",\r\n\t\trating: 3.5,\r\n\t\tnum: 62,\r\n\t},\r\n\thadronengine: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (!this.field.setTerrain('electricterrain') && this.field.isTerrain('electricterrain')) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Hadron Engine');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (this.field.isTerrain('electricterrain')) {\r\n\t\t\t\tthis.debug('Hadron Engine boost');\r\n\t\t\t\treturn this.chainModify([5461, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Hadron Engine\",\r\n\t\trating: 4.5,\r\n\t\tnum: 289,\r\n\t},\r\n\tharvest: {\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (this.field.isWeather(['sunnyday', 'desolateland']) || this.randomChance(1, 2)) {\r\n\t\t\t\tif (pokemon.hp && !pokemon.item && this.dex.items.get(pokemon.lastItem).isBerry) {\r\n\t\t\t\t\tpokemon.setItem(pokemon.lastItem);\r\n\t\t\t\t\tpokemon.lastItem = '';\r\n\t\t\t\t\tthis.add('-item', pokemon, pokemon.getItem(), '[from] ability: Harvest');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Harvest\",\r\n\t\trating: 2.5,\r\n\t\tnum: 139,\r\n\t},\r\n\thealer: {\r\n\t\tonResidualOrder: 5,\r\n\t\tonResidualSubOrder: 3,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tfor (const allyActive of pokemon.adjacentAllies()) {\r\n\t\t\t\tif (allyActive.status && this.randomChance(3, 10)) {\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Healer');\r\n\t\t\t\t\tallyActive.cureStatus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Healer\",\r\n\t\trating: 0,\r\n\t\tnum: 131,\r\n\t},\r\n\theatproof: {\r\n\t\tonSourceModifyAtkPriority: 6,\r\n\t\tonSourceModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\tthis.debug('Heatproof Atk weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifySpAPriority: 5,\r\n\t\tonSourceModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\tthis.debug('Heatproof SpA weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect && effect.id === 'brn') {\r\n\t\t\t\treturn damage / 2;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Heatproof\",\r\n\t\trating: 2,\r\n\t\tnum: 85,\r\n\t},\r\n\theavymetal: {\r\n\t\tonModifyWeightPriority: 1,\r\n\t\tonModifyWeight(weighthg) {\r\n\t\t\treturn weighthg * 2;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Heavy Metal\",\r\n\t\trating: 0,\r\n\t\tnum: 134,\r\n\t},\r\n\thoneygather: {\r\n\t\tflags: {},\r\n\t\tname: \"Honey Gather\",\r\n\t\trating: 0,\r\n\t\tnum: 118,\r\n\t},\r\n\thospitality: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tfor (const ally of pokemon.adjacentAllies()) {\r\n\t\t\t\tthis.heal(ally.baseMaxhp / 4, ally, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Hospitality\",\r\n\t\trating: 0,\r\n\t\tnum: 299,\r\n\t},\r\n\thugepower: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk) {\r\n\t\t\treturn this.chainModify(2);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Huge Power\",\r\n\t\trating: 5,\r\n\t\tnum: 37,\r\n\t},\r\n\thungerswitch: {\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.species.baseSpecies !== 'Morpeko' || pokemon.terastallized) return;\r\n\t\t\tconst targetForme = pokemon.species.name === 'Morpeko' ? 'Morpeko-Hangry' : 'Morpeko';\r\n\t\t\tpokemon.formeChange(targetForme);\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Hunger Switch\",\r\n\t\trating: 1,\r\n\t\tnum: 258,\r\n\t},\r\n\thustle: {\r\n\t\t// This should be applied directly to the stat as opposed to chaining with the others\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk) {\r\n\t\t\treturn this.modify(atk, 1.5);\r\n\t\t},\r\n\t\tonSourceModifyAccuracyPriority: -1,\r\n\t\tonSourceModifyAccuracy(accuracy, target, source, move) {\r\n\t\t\tif (move.category === 'Physical' && typeof accuracy === 'number') {\r\n\t\t\t\treturn this.chainModify([3277, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Hustle\",\r\n\t\trating: 3.5,\r\n\t\tnum: 55,\r\n\t},\r\n\thydration: {\r\n\t\tonResidualOrder: 5,\r\n\t\tonResidualSubOrder: 3,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.status && ['raindance', 'primordialsea'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\tthis.debug('hydration');\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Hydration');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Hydration\",\r\n\t\trating: 1.5,\r\n\t\tnum: 93,\r\n\t},\r\n\thypercutter: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tif (boost.atk && boost.atk < 0) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tif (!(effect as ActiveMove).secondaries) {\r\n\t\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"Attack\", \"[from] ability: Hyper Cutter\", `[of] ${target}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Hyper Cutter\",\r\n\t\trating: 1.5,\r\n\t\tnum: 52,\r\n\t},\r\n\ticebody: {\r\n\t\tonWeather(target, source, effect) {\r\n\t\t\tif (effect.id === 'hail' || effect.id === 'snowscape') {\r\n\t\t\t\tthis.heal(target.baseMaxhp / 16);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'hail') return false;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Ice Body\",\r\n\t\trating: 1,\r\n\t\tnum: 115,\r\n\t},\r\n\ticeface: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.field.isWeather(['hail', 'snowscape']) && pokemon.species.id === 'eiscuenoice') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Ice Face');\r\n\t\t\t\tthis.effectState.busted = false;\r\n\t\t\t\tpokemon.formeChange('Eiscue', this.effect, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDamagePriority: 1,\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect?.effectType === 'Move' && effect.category === 'Physical' && target.species.id === 'eiscue') {\r\n\t\t\t\tthis.add('-activate', target, 'ability: Ice Face');\r\n\t\t\t\tthis.effectState.busted = true;\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonCriticalHit(target, type, move) {\r\n\t\t\tif (!target) return;\r\n\t\t\tif (move.category !== 'Physical' || target.species.id !== 'eiscue') return;\r\n\t\t\tif (target.volatiles['substitute'] && !(move.flags['bypasssub'] || move.infiltrates)) return;\r\n\t\t\tif (!target.runImmunity(move)) return;\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonEffectiveness(typeMod, target, type, move) {\r\n\t\t\tif (!target) return;\r\n\t\t\tif (move.category !== 'Physical' || target.species.id !== 'eiscue') return;\r\n\r\n\t\t\tconst hitSub = target.volatiles['substitute'] && !move.flags['bypasssub'] && !(move.infiltrates && this.gen >= 6);\r\n\t\t\tif (hitSub) return;\r\n\r\n\t\t\tif (!target.runImmunity(move)) return;\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.species.id === 'eiscue' && this.effectState.busted) {\r\n\t\t\t\tpokemon.formeChange('Eiscue-Noice', this.effect, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonWeatherChange(pokemon, source, sourceEffect) {\r\n\t\t\t// snow/hail resuming because Cloud Nine/Air Lock ended does not trigger Ice Face\r\n\t\t\tif ((sourceEffect as Ability)?.suppressWeather) return;\r\n\t\t\tif (!pokemon.hp) return;\r\n\t\t\tif (this.field.isWeather(['hail', 'snowscape']) && pokemon.species.id === 'eiscuenoice') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Ice Face');\r\n\t\t\t\tthis.effectState.busted = false;\r\n\t\t\t\tpokemon.formeChange('Eiscue', this.effect, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {\r\n\t\t\tfailroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1,\r\n\t\t\tbreakable: 1, notransform: 1,\r\n\t\t},\r\n\t\tname: \"Ice Face\",\r\n\t\trating: 3,\r\n\t\tnum: 248,\r\n\t},\r\n\ticescales: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (move.category === 'Special') {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Ice Scales\",\r\n\t\trating: 4,\r\n\t\tnum: 246,\r\n\t},\r\n\tilluminate: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tif (boost.accuracy && boost.accuracy < 0) {\r\n\t\t\t\tdelete boost.accuracy;\r\n\t\t\t\tif (!(effect as ActiveMove).secondaries) {\r\n\t\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"accuracy\", \"[from] ability: Illuminate\", `[of] ${target}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreEvasion = true;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Illuminate\",\r\n\t\trating: 0.5,\r\n\t\tnum: 35,\r\n\t},\r\n\tillusion: {\r\n\t\tonBeforeSwitchIn(pokemon) {\r\n\t\t\tpokemon.illusion = null;\r\n\t\t\t// yes, you can Illusion an active pokemon but only if it's to your right\r\n\t\t\tfor (let i = pokemon.side.pokemon.length - 1; i > pokemon.position; i--) {\r\n\t\t\t\tconst possibleTarget = pokemon.side.pokemon[i];\r\n\t\t\t\tif (!possibleTarget.fainted) {\r\n\t\t\t\t\t// If Ogerpon is in the last slot while the Illusion Pokemon is Terastallized\r\n\t\t\t\t\t// Illusion will not disguise as anything\r\n\t\t\t\t\tif (!pokemon.terastallized || !['Ogerpon', 'Terapagos'].includes(possibleTarget.species.baseSpecies)) {\r\n\t\t\t\t\t\tpokemon.illusion = possibleTarget;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (target.illusion) {\r\n\t\t\t\tthis.singleEvent('End', this.dex.abilities.get('Illusion'), target.abilityState, target, source, move);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tif (pokemon.illusion) {\r\n\t\t\t\tthis.debug('illusion cleared');\r\n\t\t\t\tpokemon.illusion = null;\r\n\t\t\t\tconst details = pokemon.getUpdatedDetails();\r\n\t\t\t\tthis.add('replace', pokemon, details);\r\n\t\t\t\tthis.add('-end', pokemon, 'Illusion');\r\n\t\t\t\tif (this.ruleTable.has('illusionlevelmod')) {\r\n\t\t\t\t\tthis.hint(\"Illusion Level Mod is active, so this Pok\\u00e9mon's true level was hidden.\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonFaint(pokemon) {\r\n\t\t\tpokemon.illusion = null;\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1 },\r\n\t\tname: \"Illusion\",\r\n\t\trating: 4.5,\r\n\t\tnum: 149,\r\n\t},\r\n\timmunity: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'psn' || pokemon.status === 'tox') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Immunity');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'psn' && status.id !== 'tox') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Immunity');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Immunity\",\r\n\t\trating: 2,\r\n\t\tnum: 17,\r\n\t},\r\n\timposter: {\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\t// Imposter does not activate when Skill Swapped or when Neutralizing Gas leaves the field\r\n\t\t\t// Imposter copies across in doubles/triples\r\n\t\t\t// (also copies across in multibattle and diagonally in free-for-all,\r\n\t\t\t// but side.foe already takes care of those)\r\n\t\t\tconst target = pokemon.side.foe.active[pokemon.side.foe.active.length - 1 - pokemon.position];\r\n\t\t\tif (target) {\r\n\t\t\t\tpokemon.transformInto(target, this.dex.abilities.get('imposter'));\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1 },\r\n\t\tname: \"Imposter\",\r\n\t\trating: 5,\r\n\t\tnum: 150,\r\n\t},\r\n\tinfiltrator: {\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.infiltrates = true;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Infiltrator\",\r\n\t\trating: 2.5,\r\n\t\tnum: 151,\r\n\t},\r\n\tinnardsout: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (!target.hp) {\r\n\t\t\t\tthis.damage(target.getUndynamaxedHP(damage), source, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Innards Out\",\r\n\t\trating: 4,\r\n\t\tnum: 215,\r\n\t},\r\n\tinnerfocus: {\r\n\t\tonTryAddVolatile(status, pokemon) {\r\n\t\t\tif (status.id === 'flinch') return null;\r\n\t\t},\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (effect.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tthis.add('-fail', target, 'unboost', 'Attack', '[from] ability: Inner Focus', `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Inner Focus\",\r\n\t\trating: 1,\r\n\t\tnum: 39,\r\n\t},\r\n\tinsomnia: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'slp') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Insomnia');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'slp') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Insomnia');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonTryAddVolatile(status, target) {\r\n\t\t\tif (status.id === 'yawn') {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Insomnia');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Insomnia\",\r\n\t\trating: 1.5,\r\n\t\tnum: 15,\r\n\t},\r\n\tintimidate: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tlet activated = false;\r\n\t\t\tfor (const target of pokemon.adjacentFoes()) {\r\n\t\t\t\tif (!activated) {\r\n\t\t\t\t\tthis.add('-ability', pokemon, 'Intimidate', 'boost');\r\n\t\t\t\t\tactivated = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (target.volatiles['substitute']) {\r\n\t\t\t\t\tthis.add('-immune', target);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.boost({ atk: -1 }, target, pokemon, null, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Intimidate\",\r\n\t\trating: 3.5,\r\n\t\tnum: 22,\r\n\t},\r\n\tintrepidsword: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.swordBoost) return;\r\n\t\t\tpokemon.swordBoost = true;\r\n\t\t\tthis.boost({ atk: 1 }, pokemon);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Intrepid Sword\",\r\n\t\trating: 4,\r\n\t\tnum: 234,\r\n\t},\r\n\tironbarbs: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, true)) {\r\n\t\t\t\tthis.damage(source.baseMaxhp / 8, source, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Iron Barbs\",\r\n\t\trating: 2.5,\r\n\t\tnum: 160,\r\n\t},\r\n\tironfist: {\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['punch']) {\r\n\t\t\t\tthis.debug('Iron Fist boost');\r\n\t\t\t\treturn this.chainModify([4915, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Iron Fist\",\r\n\t\trating: 3,\r\n\t\tnum: 89,\r\n\t},\r\n\tjustified: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (move.type === 'Dark') {\r\n\t\t\t\tthis.boost({ atk: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Justified\",\r\n\t\trating: 2.5,\r\n\t\tnum: 154,\r\n\t},\r\n\tkeeneye: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tif (boost.accuracy && boost.accuracy < 0) {\r\n\t\t\t\tdelete boost.accuracy;\r\n\t\t\t\tif (!(effect as ActiveMove).secondaries) {\r\n\t\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"accuracy\", \"[from] ability: Keen Eye\", `[of] ${target}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreEvasion = true;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Keen Eye\",\r\n\t\trating: 0.5,\r\n\t\tnum: 51,\r\n\t},\r\n\tklutz: {\r\n\t\t// Klutz isn't technically active immediately in-game, but it activates early enough to beat all items\r\n\t\t// we should keep an eye out in future gens for items that activate on switch-in before Unnerve\r\n\t\tonSwitchInPriority: 1,\r\n\t\t// Item suppression implemented in Pokemon.ignoringItem() within sim/pokemon.js\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('End', pokemon.getItem(), pokemon.itemState, pokemon);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Klutz\",\r\n\t\trating: -1,\r\n\t\tnum: 103,\r\n\t},\r\n\tleafguard: {\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(target.effectiveWeather())) {\r\n\t\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Leaf Guard');\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryAddVolatile(status, target) {\r\n\t\t\tif (status.id === 'yawn' && ['sunnyday', 'desolateland'].includes(target.effectiveWeather())) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Leaf Guard');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Leaf Guard\",\r\n\t\trating: 0.5,\r\n\t\tnum: 102,\r\n\t},\r\n\tlevitate: {\r\n\t\t// airborneness implemented in sim/pokemon.js:Pokemon#isGrounded\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Levitate\",\r\n\t\trating: 3.5,\r\n\t\tnum: 26,\r\n\t},\r\n\tlibero: {\r\n\t\tonPrepareHit(source, target, move) {\r\n\t\t\tif (this.effectState.libero) return;\r\n\t\t\tif (move.hasBounced || move.flags['futuremove'] || move.sourceEffect === 'snatch' || move.callsMove) return;\r\n\t\t\tconst type = move.type;\r\n\t\t\tif (type && type !== '???' && source.getTypes().join() !== type) {\r\n\t\t\t\tif (!source.setType(type)) return;\r\n\t\t\t\tthis.effectState.libero = true;\r\n\t\t\t\tthis.add('-start', source, 'typechange', type, '[from] ability: Libero');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Libero\",\r\n\t\trating: 4,\r\n\t\tnum: 236,\r\n\t},\r\n\tlightmetal: {\r\n\t\tonModifyWeight(weighthg) {\r\n\t\t\treturn this.trunc(weighthg / 2);\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Light Metal\",\r\n\t\trating: 1,\r\n\t\tnum: 135,\r\n\t},\r\n\tlightningrod: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Electric') {\r\n\t\t\t\tif (!this.boost({ spa: 1 })) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Lightning Rod');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAnyRedirectTarget(target, source, source2, move) {\r\n\t\t\tif (move.type !== 'Electric' || move.flags['pledgecombo']) return;\r\n\t\t\tconst redirectTarget = ['randomNormal', 'adjacentFoe'].includes(move.target) ? 'normal' : move.target;\r\n\t\t\tif (this.validTarget(this.effectState.target, source, redirectTarget)) {\r\n\t\t\t\tif (move.smartTarget) move.smartTarget = false;\r\n\t\t\t\tif (this.effectState.target !== target) {\r\n\t\t\t\t\tthis.add('-activate', this.effectState.target, 'ability: Lightning Rod');\r\n\t\t\t\t}\r\n\t\t\t\treturn this.effectState.target;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Lightning Rod\",\r\n\t\trating: 3,\r\n\t\tnum: 31,\r\n\t},\r\n\tlimber: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'par') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Limber');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'par') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Limber');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Limber\",\r\n\t\trating: 2,\r\n\t\tnum: 7,\r\n\t},\r\n\tlingeringaroma: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tconst sourceAbility = source.getAbility();\r\n\t\t\tif (sourceAbility.flags['cantsuppress'] || sourceAbility.id === 'lingeringaroma') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, !source.isAlly(target))) {\r\n\t\t\t\tconst oldAbility = source.setAbility('lingeringaroma', target);\r\n\t\t\t\tif (oldAbility) {\r\n\t\t\t\t\tthis.add('-activate', target, 'ability: Lingering Aroma', this.dex.abilities.get(oldAbility).name, `[of] ${source}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Lingering Aroma\",\r\n\t\trating: 2,\r\n\t\tnum: 268,\r\n\t},\r\n\tliquidooze: {\r\n\t\tonSourceTryHeal(damage, target, source, effect) {\r\n\t\t\tthis.debug(`Heal is occurring: ${target} <- ${source} :: ${effect.id}`);\r\n\t\t\tconst canOoze = ['drain', 'leechseed', 'strengthsap'];\r\n\t\t\tif (canOoze.includes(effect.id)) {\r\n\t\t\t\tthis.damage(damage);\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Liquid Ooze\",\r\n\t\trating: 2.5,\r\n\t\tnum: 64,\r\n\t},\r\n\tliquidvoice: {\r\n\t\tonModifyTypePriority: -1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tif (move.flags['sound'] && !pokemon.volatiles['dynamax']) { // hardcode\r\n\t\t\t\tmove.type = 'Water';\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Liquid Voice\",\r\n\t\trating: 1.5,\r\n\t\tnum: 204,\r\n\t},\r\n\tlongreach: {\r\n\t\tonModifyMove(move) {\r\n\t\t\tdelete move.flags['contact'];\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Long Reach\",\r\n\t\trating: 1,\r\n\t\tnum: 203,\r\n\t},\r\n\tmagicbounce: {\r\n\t\tonTryHitPriority: 1,\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target === source || move.hasBounced || !move.flags['reflectable'] || target.isSemiInvulnerable()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newMove = this.dex.getActiveMove(move.id);\r\n\t\t\tnewMove.hasBounced = true;\r\n\t\t\tnewMove.pranksterBoosted = false;\r\n\t\t\tthis.actions.useMove(newMove, target, { target: source });\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tonAllyTryHitSide(target, source, move) {\r\n\t\t\tif (target.isAlly(source) || move.hasBounced || !move.flags['reflectable'] || target.isSemiInvulnerable()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newMove = this.dex.getActiveMove(move.id);\r\n\t\t\tnewMove.hasBounced = true;\r\n\t\t\tnewMove.pranksterBoosted = false;\r\n\t\t\tthis.actions.useMove(newMove, this.effectState.target, { target: source });\r\n\t\t\tmove.hasBounced = true; // only bounce once in free-for-all battles\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Magic Bounce\",\r\n\t\trating: 4,\r\n\t\tnum: 156,\r\n\t},\r\n\tmagicguard: {\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect.effectType !== 'Move') {\r\n\t\t\t\tif (effect.effectType === 'Ability') this.add('-activate', source, 'ability: ' + effect.name);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Magic Guard\",\r\n\t\trating: 4,\r\n\t\tnum: 98,\r\n\t},\r\n\tmagician: {\r\n\t\tonAfterMoveSecondarySelf(source, target, move) {\r\n\t\t\tif (!move || source.switchFlag === true || !move.hitTargets || source.item || source.volatiles['gem'] ||\r\n\t\t\t\tmove.id === 'fling' || move.category === 'Status') return;\r\n\t\t\tconst hitTargets = move.hitTargets;\r\n\t\t\tthis.speedSort(hitTargets);\r\n\t\t\tfor (const pokemon of hitTargets) {\r\n\t\t\t\tif (pokemon !== source) {\r\n\t\t\t\t\tconst yourItem = pokemon.takeItem(source);\r\n\t\t\t\t\tif (!yourItem) continue;\r\n\t\t\t\t\tif (!source.setItem(yourItem)) {\r\n\t\t\t\t\t\tpokemon.item = yourItem.id; // bypass setItem so we don't break choicelock or anything\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.add('-item', source, yourItem, '[from] ability: Magician', `[of] ${pokemon}`);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Magician\",\r\n\t\trating: 1,\r\n\t\tnum: 170,\r\n\t},\r\n\tmagmaarmor: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'frz') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Magma Armor');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'frz') return false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Magma Armor\",\r\n\t\trating: 0.5,\r\n\t\tnum: 40,\r\n\t},\r\n\tmagnetpull: {\r\n\t\tonFoeTrapPokemon(pokemon) {\r\n\t\t\tif (pokemon.hasType('Steel') && pokemon.isAdjacent(this.effectState.target)) {\r\n\t\t\t\tpokemon.tryTrap(true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonFoeMaybeTrapPokemon(pokemon, source) {\r\n\t\t\tif (!source) source = this.effectState.target;\r\n\t\t\tif (!source || !pokemon.isAdjacent(source)) return;\r\n\t\t\tif (!pokemon.knownType || pokemon.hasType('Steel')) {\r\n\t\t\t\tpokemon.maybeTrapped = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Magnet Pull\",\r\n\t\trating: 4,\r\n\t\tnum: 42,\r\n\t},\r\n\tmarvelscale: {\r\n\t\tonModifyDefPriority: 6,\r\n\t\tonModifyDef(def, pokemon) {\r\n\t\t\tif (pokemon.status) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Marvel Scale\",\r\n\t\trating: 2.5,\r\n\t\tnum: 63,\r\n\t},\r\n\tmegalauncher: {\r\n\t\tonBasePowerPriority: 19,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['pulse']) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Mega Launcher\",\r\n\t\trating: 3,\r\n\t\tnum: 178,\r\n\t},\r\n\tmerciless: {\r\n\t\tonModifyCritRatio(critRatio, source, target) {\r\n\t\t\tif (target && ['psn', 'tox'].includes(target.status)) return 5;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Merciless\",\r\n\t\trating: 1.5,\r\n\t\tnum: 196,\r\n\t},\r\n\tmimicry: {\r\n\t\tonSwitchInPriority: -1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('TerrainChange', this.effect, this.effectState, pokemon);\r\n\t\t},\r\n\t\tonTerrainChange(pokemon) {\r\n\t\t\tlet types;\r\n\t\t\tswitch (this.field.terrain) {\r\n\t\t\tcase 'electricterrain':\r\n\t\t\t\ttypes = ['Electric'];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'grassyterrain':\r\n\t\t\t\ttypes = ['Grass'];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'mistyterrain':\r\n\t\t\t\ttypes = ['Fairy'];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'psychicterrain':\r\n\t\t\t\ttypes = ['Psychic'];\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\ttypes = pokemon.baseSpecies.types;\r\n\t\t\t}\r\n\t\t\tconst oldTypes = pokemon.getTypes();\r\n\t\t\tif (oldTypes.join() === types.join() || !pokemon.setType(types)) return;\r\n\t\t\tif (this.field.terrain || pokemon.transformed) {\r\n\t\t\t\tthis.add('-start', pokemon, 'typechange', types.join('/'), '[from] ability: Mimicry');\r\n\t\t\t\tif (!this.field.terrain) this.hint(\"Transform Mimicry changes you to your original un-transformed types.\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Mimicry');\r\n\t\t\t\tthis.add('-end', pokemon, 'typechange', '[silent]');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Mimicry\",\r\n\t\trating: 0,\r\n\t\tnum: 250,\r\n\t},\r\n\tmindseye: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tif (boost.accuracy && boost.accuracy < 0) {\r\n\t\t\t\tdelete boost.accuracy;\r\n\t\t\t\tif (!(effect as ActiveMove).secondaries) {\r\n\t\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"accuracy\", \"[from] ability: Mind's Eye\", `[of] ${target}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMovePriority: -5,\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreEvasion = true;\r\n\t\t\tif (!move.ignoreImmunity) move.ignoreImmunity = {};\r\n\t\t\tif (move.ignoreImmunity !== true) {\r\n\t\t\t\tmove.ignoreImmunity['Fighting'] = true;\r\n\t\t\t\tmove.ignoreImmunity['Normal'] = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Mind's Eye\",\r\n\t\trating: 0,\r\n\t\tnum: 300,\r\n\t},\r\n\tminus: {\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(spa, pokemon) {\r\n\t\t\tfor (const allyActive of pokemon.allies()) {\r\n\t\t\t\tif (allyActive.hasAbility(['minus', 'plus'])) {\r\n\t\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Minus\",\r\n\t\trating: 0,\r\n\t\tnum: 58,\r\n\t},\r\n\tmirrorarmor: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\t// Don't bounce self stat changes, or boosts that have already bounced\r\n\t\t\tif (!source || target === source || !boost || effect.name === 'Mirror Armor') return;\r\n\t\t\tlet b: BoostID;\r\n\t\t\tfor (b in boost) {\r\n\t\t\t\tif (boost[b]! < 0) {\r\n\t\t\t\t\tif (target.boosts[b] === -6) continue;\r\n\t\t\t\t\tconst negativeBoost: SparseBoostsTable = {};\r\n\t\t\t\t\tnegativeBoost[b] = boost[b];\r\n\t\t\t\t\tdelete boost[b];\r\n\t\t\t\t\tif (source.hp) {\r\n\t\t\t\t\t\tthis.add('-ability', target, 'Mirror Armor');\r\n\t\t\t\t\t\tthis.boost(negativeBoost, source, target, null, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Mirror Armor\",\r\n\t\trating: 2,\r\n\t\tnum: 240,\r\n\t},\r\n\tmistysurge: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setTerrain('mistyterrain');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Misty Surge\",\r\n\t\trating: 3.5,\r\n\t\tnum: 228,\r\n\t},\r\n\tmoldbreaker: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Mold Breaker');\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreAbility = true;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Mold Breaker\",\r\n\t\trating: 3,\r\n\t\tnum: 104,\r\n\t},\r\n\tmoody: {\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tlet stats: BoostID[] = [];\r\n\t\t\tconst boost: SparseBoostsTable = {};\r\n\t\t\tlet statPlus: BoostID;\r\n\t\t\tfor (statPlus in pokemon.boosts) {\r\n\t\t\t\tif (statPlus === 'accuracy' || statPlus === 'evasion') continue;\r\n\t\t\t\tif (pokemon.boosts[statPlus] < 6) {\r\n\t\t\t\t\tstats.push(statPlus);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet randomStat: BoostID | undefined = stats.length ? this.sample(stats) : undefined;\r\n\t\t\tif (randomStat) boost[randomStat] = 2;\r\n\r\n\t\t\tstats = [];\r\n\t\t\tlet statMinus: BoostID;\r\n\t\t\tfor (statMinus in pokemon.boosts) {\r\n\t\t\t\tif (statMinus === 'accuracy' || statMinus === 'evasion') continue;\r\n\t\t\t\tif (pokemon.boosts[statMinus] > -6 && statMinus !== randomStat) {\r\n\t\t\t\t\tstats.push(statMinus);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trandomStat = stats.length ? this.sample(stats) : undefined;\r\n\t\t\tif (randomStat) boost[randomStat] = -1;\r\n\r\n\t\t\tthis.boost(boost, pokemon, pokemon);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Moody\",\r\n\t\trating: 5,\r\n\t\tnum: 141,\r\n\t},\r\n\tmotordrive: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Electric') {\r\n\t\t\t\tif (!this.boost({ spe: 1 })) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Motor Drive');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Motor Drive\",\r\n\t\trating: 3,\r\n\t\tnum: 78,\r\n\t},\r\n\tmoxie: {\r\n\t\tonSourceAfterFaint(length, target, source, effect) {\r\n\t\t\tif (effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.boost({ atk: length }, source);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Moxie\",\r\n\t\trating: 3,\r\n\t\tnum: 153,\r\n\t},\r\n\tmultiscale: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.hp >= target.maxhp) {\r\n\t\t\t\tthis.debug('Multiscale weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Multiscale\",\r\n\t\trating: 3.5,\r\n\t\tnum: 136,\r\n\t},\r\n\tmultitype: {\r\n\t\t// Multitype's type-changing itself is implemented in statuses.js\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Multitype\",\r\n\t\trating: 4,\r\n\t\tnum: 121,\r\n\t},\r\n\tmummy: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tconst sourceAbility = source.getAbility();\r\n\t\t\tif (sourceAbility.flags['cantsuppress'] || sourceAbility.id === 'mummy') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, !source.isAlly(target))) {\r\n\t\t\t\tconst oldAbility = source.setAbility('mummy', target);\r\n\t\t\t\tif (oldAbility) {\r\n\t\t\t\t\tthis.add('-activate', target, 'ability: Mummy', this.dex.abilities.get(oldAbility).name, `[of] ${source}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Mummy\",\r\n\t\trating: 2,\r\n\t\tnum: 152,\r\n\t},\r\n\tmyceliummight: {\r\n\t\tonFractionalPriorityPriority: -1,\r\n\t\tonFractionalPriority(priority, pokemon, target, move) {\r\n\t\t\tif (move.category === 'Status') {\r\n\t\t\t\treturn -0.1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (move.category === 'Status') {\r\n\t\t\t\tmove.ignoreAbility = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Mycelium Might\",\r\n\t\trating: 2,\r\n\t\tnum: 298,\r\n\t},\r\n\tnaturalcure: {\r\n\t\tonCheckShow(pokemon) {\r\n\t\t\t// This is complicated\r\n\t\t\t// For the most part, in-game, it's obvious whether or not Natural Cure activated,\r\n\t\t\t// since you can see how many of your opponent's pokemon are statused.\r\n\t\t\t// The only ambiguous situation happens in Doubles/Triples, where multiple pokemon\r\n\t\t\t// that could have Natural Cure switch out, but only some of them get cured.\r\n\t\t\tif (pokemon.side.active.length === 1) return;\r\n\t\t\tif (pokemon.showCure === true || pokemon.showCure === false) return;\r\n\r\n\t\t\tconst cureList = [];\r\n\t\t\tlet noCureCount = 0;\r\n\t\t\tfor (const curPoke of pokemon.side.active) {\r\n\t\t\t\t// pokemon not statused\r\n\t\t\t\tif (!curPoke?.status) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" skipped: not statused or doesn't exist\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (curPoke.showCure) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" skipped: Natural Cure already known\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst species = curPoke.species;\r\n\t\t\t\t// pokemon can't get Natural Cure\r\n\t\t\t\tif (!Object.values(species.abilities).includes('Natural Cure')) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" skipped: no Natural Cure\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// pokemon's ability is known to be Natural Cure\r\n\t\t\t\tif (!species.abilities['1'] && !species.abilities['H']) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" skipped: only one ability\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// pokemon isn't switching this turn\r\n\t\t\t\tif (curPoke !== pokemon && !this.queue.willSwitch(curPoke)) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" skipped: not switching\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (curPoke.hasAbility('naturalcure')) {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" confirmed: could be Natural Cure (and is)\");\r\n\t\t\t\t\tcureList.push(curPoke);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// this.add('-message', \"\" + curPoke + \" confirmed: could be Natural Cure (but isn't)\");\r\n\t\t\t\t\tnoCureCount++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!cureList.length || !noCureCount) {\r\n\t\t\t\t// It's possible to know what pokemon were cured\r\n\t\t\t\tfor (const pkmn of cureList) {\r\n\t\t\t\t\tpkmn.showCure = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// It's not possible to know what pokemon were cured\r\n\r\n\t\t\t\t// Unlike a -hint, this is real information that battlers need, so we use a -message\r\n\t\t\t\tthis.add('-message', `(${cureList.length} of ${pokemon.side.name}'s pokemon ${cureList.length === 1 ? \"was\" : \"were\"} cured by Natural Cure.)`);\r\n\r\n\t\t\t\tfor (const pkmn of cureList) {\r\n\t\t\t\t\tpkmn.showCure = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSwitchOut(pokemon) {\r\n\t\t\tif (!pokemon.status) return;\r\n\r\n\t\t\t// if pokemon.showCure is undefined, it was skipped because its ability\r\n\t\t\t// is known\r\n\t\t\tif (pokemon.showCure === undefined) pokemon.showCure = true;\r\n\r\n\t\t\tif (pokemon.showCure) this.add('-curestatus', pokemon, pokemon.status, '[from] ability: Natural Cure');\r\n\t\t\tpokemon.clearStatus();\r\n\r\n\t\t\t// only reset .showCure if it's false\r\n\t\t\t// (once you know a Pokemon has Natural Cure, its cures are always known)\r\n\t\t\tif (!pokemon.showCure) pokemon.showCure = undefined;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Natural Cure\",\r\n\t\trating: 2.5,\r\n\t\tnum: 30,\r\n\t},\r\n\tneuroforce: {\r\n\t\tonModifyDamage(damage, source, target, move) {\r\n\t\t\tif (move && target.getMoveHitData(move).typeMod > 0) {\r\n\t\t\t\treturn this.chainModify([5120, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Neuroforce\",\r\n\t\trating: 2.5,\r\n\t\tnum: 233,\r\n\t},\r\n\tneutralizinggas: {\r\n\t\t// Ability suppression implemented in sim/pokemon.ts:Pokemon#ignoringAbility\r\n\t\tonSwitchInPriority: 2,\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Neutralizing Gas');\r\n\t\t\tpokemon.abilityState.ending = false;\r\n\t\t\tconst strongWeathers = ['desolateland', 'primordialsea', 'deltastream'];\r\n\t\t\tfor (const target of this.getAllActive()) {\r\n\t\t\t\tif (target.hasItem('Ability Shield')) {\r\n\t\t\t\t\tthis.add('-block', target, 'item: Ability Shield');\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// Can't suppress a Tatsugiri inside of Dondozo already\r\n\t\t\t\tif (target.volatiles['commanding']) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (target.illusion) {\r\n\t\t\t\t\tthis.singleEvent('End', this.dex.abilities.get('Illusion'), target.abilityState, target, pokemon, 'neutralizinggas');\r\n\t\t\t\t}\r\n\t\t\t\tif (target.volatiles['slowstart']) {\r\n\t\t\t\t\tdelete target.volatiles['slowstart'];\r\n\t\t\t\t\tthis.add('-end', target, 'Slow Start', '[silent]');\r\n\t\t\t\t}\r\n\t\t\t\tif (strongWeathers.includes(target.getAbility().id)) {\r\n\t\t\t\t\tthis.singleEvent('End', this.dex.abilities.get(target.getAbility().id), target.abilityState, target, pokemon, 'neutralizinggas');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(source) {\r\n\t\t\tif (source.transformed) return;\r\n\t\t\tfor (const pokemon of this.getAllActive()) {\r\n\t\t\t\tif (pokemon !== source && pokemon.hasAbility('Neutralizing Gas')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.add('-end', source, 'ability: Neutralizing Gas');\r\n\r\n\t\t\t// FIXME this happens before the pokemon switches out, should be the opposite order.\r\n\t\t\t// Not an easy fix since we cant use a supported event. Would need some kind of special event that\r\n\t\t\t// gathers events to run after the switch and then runs them when the ability is no longer accessible.\r\n\t\t\t// (If you're tackling this, do note extreme weathers have the same issue)\r\n\r\n\t\t\t// Mark this pokemon's ability as ending so Pokemon#ignoringAbility skips it\r\n\t\t\tif (source.abilityState.ending) return;\r\n\t\t\tsource.abilityState.ending = true;\r\n\t\t\tconst sortedActive = this.getAllActive();\r\n\t\t\tthis.speedSort(sortedActive);\r\n\t\t\tfor (const pokemon of sortedActive) {\r\n\t\t\t\tif (pokemon !== source) {\r\n\t\t\t\t\tif (pokemon.getAbility().flags['cantsuppress']) continue; // does not interact with e.g Ice Face, Zen Mode\r\n\t\t\t\t\tif (pokemon.hasItem('abilityshield')) continue; // don't restart abilities that weren't suppressed\r\n\r\n\t\t\t\t\t// Will be suppressed by Pokemon#ignoringAbility if needed\r\n\t\t\t\t\tthis.singleEvent('Start', pokemon.getAbility(), pokemon.abilityState, pokemon);\r\n\t\t\t\t\tif (pokemon.ability === \"gluttony\") {\r\n\t\t\t\t\t\tpokemon.abilityState.gluttony = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Neutralizing Gas\",\r\n\t\trating: 3.5,\r\n\t\tnum: 256,\r\n\t},\r\n\tnoguard: {\r\n\t\tonAnyInvulnerabilityPriority: 1,\r\n\t\tonAnyInvulnerability(target, source, move) {\r\n\t\t\tif (move && (source === this.effectState.target || target === this.effectState.target)) return 0;\r\n\t\t},\r\n\t\tonAnyAccuracy(accuracy, target, source, move) {\r\n\t\t\tif (move && (source === this.effectState.target || target === this.effectState.target)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn accuracy;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"No Guard\",\r\n\t\trating: 4,\r\n\t\tnum: 99,\r\n\t},\r\n\tnormalize: {\r\n\t\tonModifyTypePriority: 1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tconst noModifyType = [\r\n\t\t\t\t'hiddenpower', 'judgment', 'multiattack', 'naturalgift', 'revelationdance', 'struggle', 'technoblast', 'terrainpulse', 'weatherball',\r\n\t\t\t];\r\n\t\t\tif (!(move.isZ && move.category !== 'Status') &&\r\n\t\t\t\t// TODO: Figure out actual interaction\r\n\t\t\t\t(!noModifyType.includes(move.id) || this.activeMove?.isMax) && !(move.name === 'Tera Blast' && pokemon.terastallized)) {\r\n\t\t\t\tmove.type = 'Normal';\r\n\t\t\t\tmove.typeChangerBoosted = this.effect;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.typeChangerBoosted === this.effect) return this.chainModify([4915, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Normalize\",\r\n\t\trating: 0,\r\n\t\tnum: 96,\r\n\t},\r\n\toblivious: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.volatiles['attract']) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Oblivious');\r\n\t\t\t\tpokemon.removeVolatile('attract');\r\n\t\t\t\tthis.add('-end', pokemon, 'move: Attract', '[from] ability: Oblivious');\r\n\t\t\t}\r\n\t\t\tif (pokemon.volatiles['taunt']) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Oblivious');\r\n\t\t\t\tpokemon.removeVolatile('taunt');\r\n\t\t\t\t// Taunt's volatile already sends the -end message when removed\r\n\t\t\t}\r\n\t\t},\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'attract') return false;\r\n\t\t},\r\n\t\tonTryHit(pokemon, target, move) {\r\n\t\t\tif (move.id === 'attract' || move.id === 'captivate' || move.id === 'taunt') {\r\n\t\t\t\tthis.add('-immune', pokemon, '[from] ability: Oblivious');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (effect.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tthis.add('-fail', target, 'unboost', 'Attack', '[from] ability: Oblivious', `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Oblivious\",\r\n\t\trating: 1.5,\r\n\t\tnum: 12,\r\n\t},\r\n\topportunist: {\r\n\t\tonFoeAfterBoost(boost, target, source, effect) {\r\n\t\t\tif (effect?.name === 'Opportunist' || effect?.name === 'Mirror Herb') return;\r\n\t\t\tif (!this.effectState.boosts) this.effectState.boosts = {} as SparseBoostsTable;\r\n\t\t\tconst boostPlus = this.effectState.boosts;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! > 0) {\r\n\t\t\t\t\tboostPlus[i] = (boostPlus[i] || 0) + boost[i]!;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAnySwitchInPriority: -3,\r\n\t\tonAnySwitchIn() {\r\n\t\t\tif (!this.effectState.boosts) return;\r\n\t\t\tthis.boost(this.effectState.boosts, this.effectState.target);\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tonAnyAfterMega() {\r\n\t\t\tif (!this.effectState.boosts) return;\r\n\t\t\tthis.boost(this.effectState.boosts, this.effectState.target);\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tonAnyAfterTerastallization() {\r\n\t\t\tif (!this.effectState.boosts) return;\r\n\t\t\tthis.boost(this.effectState.boosts, this.effectState.target);\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tonAnyAfterMove() {\r\n\t\t\tif (!this.effectState.boosts) return;\r\n\t\t\tthis.boost(this.effectState.boosts, this.effectState.target);\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (!this.effectState.boosts) return;\r\n\t\t\tthis.boost(this.effectState.boosts, this.effectState.target);\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tonEnd() {\r\n\t\t\tdelete this.effectState.boosts;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Opportunist\",\r\n\t\trating: 3,\r\n\t\tnum: 290,\r\n\t},\r\n\torichalcumpulse: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.field.setWeather('sunnyday')) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'Orichalcum Pulse', '[source]');\r\n\t\t\t} else if (this.field.isWeather('sunnyday')) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Orichalcum Pulse');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\tthis.debug('Orichalcum boost');\r\n\t\t\t\treturn this.chainModify([5461, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Orichalcum Pulse\",\r\n\t\trating: 4.5,\r\n\t\tnum: 288,\r\n\t},\r\n\tovercoat: {\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'sandstorm' || type === 'hail' || type === 'powder') return false;\r\n\t\t},\r\n\t\tonTryHitPriority: 1,\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (move.flags['powder'] && target !== source && this.dex.getImmunity('powder', target)) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Overcoat');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Overcoat\",\r\n\t\trating: 2,\r\n\t\tnum: 142,\r\n\t},\r\n\tovergrow: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Grass' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Overgrow boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Grass' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Overgrow boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Overgrow\",\r\n\t\trating: 2,\r\n\t\tnum: 65,\r\n\t},\r\n\towntempo: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.volatiles['confusion']) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Own Tempo');\r\n\t\t\t\tpokemon.removeVolatile('confusion');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryAddVolatile(status, pokemon) {\r\n\t\t\tif (status.id === 'confusion') return null;\r\n\t\t},\r\n\t\tonHit(target, source, move) {\r\n\t\t\tif (move?.volatileStatus === 'confusion') {\r\n\t\t\t\tthis.add('-immune', target, 'confusion', '[from] ability: Own Tempo');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (effect.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tthis.add('-fail', target, 'unboost', 'Attack', '[from] ability: Own Tempo', `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Own Tempo\",\r\n\t\trating: 1.5,\r\n\t\tnum: 20,\r\n\t},\r\n\tparentalbond: {\r\n\t\tonPrepareHit(source, target, move) {\r\n\t\t\tif (move.category === 'Status' || move.multihit || move.flags['noparentalbond'] || move.flags['charge'] ||\r\n\t\t\t\tmove.flags['futuremove'] || move.spreadHit || move.isZ || move.isMax) return;\r\n\t\t\tmove.multihit = 2;\r\n\t\t\tmove.multihitType = 'parentalbond';\r\n\t\t},\r\n\t\t// Damage modifier implemented in BattleActions#modifyDamage()\r\n\t\tonSourceModifySecondaries(secondaries, target, source, move) {\r\n\t\t\tif (move.multihitType === 'parentalbond' && move.id === 'secretpower' && move.hit < 2) {\r\n\t\t\t\t// hack to prevent accidentally suppressing King's Rock/Razor Fang\r\n\t\t\t\treturn secondaries.filter(effect => effect.volatileStatus === 'flinch');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Parental Bond\",\r\n\t\trating: 4.5,\r\n\t\tnum: 185,\r\n\t},\r\n\tpastelveil: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tfor (const ally of pokemon.alliesAndSelf()) {\r\n\t\t\t\tif (['psn', 'tox'].includes(ally.status)) {\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Pastel Veil');\r\n\t\t\t\t\tally.cureStatus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (['psn', 'tox'].includes(pokemon.status)) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Pastel Veil');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAnySwitchIn() {\r\n\t\t\t((this.effect as any).onStart as (p: Pokemon) => void).call(this, this.effectState.target);\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (!['psn', 'tox'].includes(status.id)) return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Pastel Veil');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonAllySetStatus(status, target, source, effect) {\r\n\t\t\tif (!['psn', 'tox'].includes(status.id)) return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\tthis.add('-block', target, 'ability: Pastel Veil', `[of] ${effectHolder}`);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Pastel Veil\",\r\n\t\trating: 2,\r\n\t\tnum: 257,\r\n\t},\r\n\tperishbody: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (!this.checkMoveMakesContact(move, source, target) || source.volatiles['perishsong']) return;\r\n\t\t\tthis.add('-ability', target, 'Perish Body');\r\n\t\t\tsource.addVolatile('perishsong');\r\n\t\t\ttarget.addVolatile('perishsong');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Perish Body\",\r\n\t\trating: 1,\r\n\t\tnum: 253,\r\n\t},\r\n\tpickpocket: {\r\n\t\tonAfterMoveSecondary(target, source, move) {\r\n\t\t\tif (source && source !== target && move?.flags['contact']) {\r\n\t\t\t\tif (target.item || target.switchFlag || target.forceSwitchFlag || source.switchFlag === true) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst yourItem = source.takeItem(target);\r\n\t\t\t\tif (!yourItem) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!target.setItem(yourItem)) {\r\n\t\t\t\t\tsource.item = yourItem.id;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.add('-enditem', source, yourItem, '[silent]', '[from] ability: Pickpocket', `[of] ${source}`);\r\n\t\t\t\tthis.add('-item', target, yourItem, '[from] ability: Pickpocket', `[of] ${source}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Pickpocket\",\r\n\t\trating: 1,\r\n\t\tnum: 124,\r\n\t},\r\n\tpickup: {\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.item) return;\r\n\t\t\tconst pickupTargets = this.getAllActive().filter(target => (\r\n\t\t\t\ttarget.lastItem && target.usedItemThisTurn && pokemon.isAdjacent(target)\r\n\t\t\t));\r\n\t\t\tif (!pickupTargets.length) return;\r\n\t\t\tconst randomTarget = this.sample(pickupTargets);\r\n\t\t\tconst item = randomTarget.lastItem;\r\n\t\t\trandomTarget.lastItem = '';\r\n\t\t\tthis.add('-item', pokemon, this.dex.items.get(item), '[from] ability: Pickup');\r\n\t\t\tpokemon.setItem(item);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Pickup\",\r\n\t\trating: 0.5,\r\n\t\tnum: 53,\r\n\t},\r\n\tpixilate: {\r\n\t\tonModifyTypePriority: -1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tconst noModifyType = [\r\n\t\t\t\t'judgment', 'multiattack', 'naturalgift', 'revelationdance', 'technoblast', 'terrainpulse', 'weatherball',\r\n\t\t\t];\r\n\t\t\tif (move.type === 'Normal' && (!noModifyType.includes(move.id) || this.activeMove?.isMax) &&\r\n\t\t\t\t!(move.isZ && move.category !== 'Status') && !(move.name === 'Tera Blast' && pokemon.terastallized)) {\r\n\t\t\t\tmove.type = 'Fairy';\r\n\t\t\t\tmove.typeChangerBoosted = this.effect;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.typeChangerBoosted === this.effect) return this.chainModify([4915, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Pixilate\",\r\n\t\trating: 4,\r\n\t\tnum: 182,\r\n\t},\r\n\tplus: {\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(spa, pokemon) {\r\n\t\t\tfor (const allyActive of pokemon.allies()) {\r\n\t\t\t\tif (allyActive.hasAbility(['minus', 'plus'])) {\r\n\t\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Plus\",\r\n\t\trating: 0,\r\n\t\tnum: 57,\r\n\t},\r\n\tpoisonheal: {\r\n\t\tonDamagePriority: 1,\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect.id === 'psn' || effect.id === 'tox') {\r\n\t\t\t\tthis.heal(target.baseMaxhp / 8);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Poison Heal\",\r\n\t\trating: 4,\r\n\t\tnum: 90,\r\n\t},\r\n\tpoisonpoint: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target)) {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\tsource.trySetStatus('psn', target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Poison Point\",\r\n\t\trating: 1.5,\r\n\t\tnum: 38,\r\n\t},\r\n\tpoisonpuppeteer: {\r\n\t\tonAnyAfterSetStatus(status, target, source, effect) {\r\n\t\t\tif (source.baseSpecies.name !== \"Pecharunt\") return;\r\n\t\t\tif (source !== this.effectState.target || target === source || effect.effectType !== 'Move') return;\r\n\t\t\tif (status.id === 'psn' || status.id === 'tox') {\r\n\t\t\t\ttarget.addVolatile('confusion');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1 },\r\n\t\tname: \"Poison Puppeteer\",\r\n\t\trating: 3,\r\n\t\tnum: 310,\r\n\t},\r\n\tpoisontouch: {\r\n\t\tonSourceDamagingHit(damage, target, source, move) {\r\n\t\t\t// Despite not being a secondary, Shield Dust / Covert Cloak block Poison Touch's effect\r\n\t\t\tif (target.hasAbility('shielddust') || target.hasItem('covertcloak')) return;\r\n\t\t\tif (this.checkMoveMakesContact(move, target, source)) {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\ttarget.trySetStatus('psn', source);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Poison Touch\",\r\n\t\trating: 2,\r\n\t\tnum: 143,\r\n\t},\r\n\tpowerconstruct: {\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Zygarde' || pokemon.transformed || !pokemon.hp) return;\r\n\t\t\tif (pokemon.species.id === 'zygardecomplete' || pokemon.hp > pokemon.maxhp / 2) return;\r\n\t\t\tthis.add('-activate', pokemon, 'ability: Power Construct');\r\n\t\t\tpokemon.formeChange('Zygarde-Complete', this.effect, true);\r\n\t\t\tpokemon.canMegaEvo = pokemon.canMegaEvo === false ? false : this.actions.canMegaEvo(pokemon);\r\n\t\t\tpokemon.formeRegression = true;\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Power Construct\",\r\n\t\trating: 5,\r\n\t\tnum: 211,\r\n\t},\r\n\tpowerofalchemy: {\r\n\t\tonAllyFaint(target) {\r\n\t\t\tif (!this.effectState.target.hp) return;\r\n\t\t\tconst ability = target.getAbility();\r\n\t\t\tif (ability.flags['noreceiver'] || ability.id === 'noability') return;\r\n\t\t\tthis.effectState.target.setAbility(ability, target);\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1 },\r\n\t\tname: \"Power of Alchemy\",\r\n\t\trating: 0,\r\n\t\tnum: 223,\r\n\t},\r\n\tpowerspot: {\r\n\t\tonAllyBasePowerPriority: 22,\r\n\t\tonAllyBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (attacker !== this.effectState.target) {\r\n\t\t\t\tthis.debug('Power Spot boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Power Spot\",\r\n\t\trating: 0,\r\n\t\tnum: 249,\r\n\t},\r\n\tprankster: {\r\n\t\tonModifyPriority(priority, pokemon, target, move) {\r\n\t\t\tif (move?.category === 'Status') {\r\n\t\t\t\tmove.pranksterBoosted = true;\r\n\t\t\t\treturn priority + 1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Prankster\",\r\n\t\trating: 4,\r\n\t\tnum: 158,\r\n\t},\r\n\tpressure: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Pressure');\r\n\t\t},\r\n\t\tonDeductPP(target, source) {\r\n\t\t\tif (target.isAlly(source)) return;\r\n\t\t\treturn 1;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Pressure\",\r\n\t\trating: 2.5,\r\n\t\tnum: 46,\r\n\t},\r\n\tprimordialsea: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setWeather('primordialsea');\r\n\t\t},\r\n\t\tonAnySetWeather(target, source, weather) {\r\n\t\t\tconst strongWeathers = ['desolateland', 'primordialsea', 'deltastream'];\r\n\t\t\tif (this.field.getWeather().id === 'primordialsea' && !strongWeathers.includes(weather.id)) return false;\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tif (this.field.weatherState.source !== pokemon) return;\r\n\t\t\tfor (const target of this.getAllActive()) {\r\n\t\t\t\tif (target === pokemon) continue;\r\n\t\t\t\tif (target.hasAbility('primordialsea')) {\r\n\t\t\t\t\tthis.field.weatherState.source = target;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.field.clearWeather();\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Primordial Sea\",\r\n\t\trating: 4.5,\r\n\t\tnum: 189,\r\n\t},\r\n\tprismarmor: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.getMoveHitData(move).typeMod > 0) {\r\n\t\t\t\tthis.debug('Prism Armor neutralize');\r\n\t\t\t\treturn this.chainModify(0.75);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Prism Armor\",\r\n\t\trating: 3,\r\n\t\tnum: 232,\r\n\t},\r\n\tpropellertail: {\r\n\t\tonModifyMovePriority: 1,\r\n\t\tonModifyMove(move) {\r\n\t\t\t// most of the implementation is in Battle#getTarget\r\n\t\t\tmove.tracksTarget = move.target !== 'scripted';\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Propeller Tail\",\r\n\t\trating: 0,\r\n\t\tnum: 239,\r\n\t},\r\n\tprotean: {\r\n\t\tonPrepareHit(source, target, move) {\r\n\t\t\tif (this.effectState.protean) return;\r\n\t\t\tif (move.hasBounced || move.flags['futuremove'] || move.sourceEffect === 'snatch' || move.callsMove) return;\r\n\t\t\tconst type = move.type;\r\n\t\t\tif (type && type !== '???' && source.getTypes().join() !== type) {\r\n\t\t\t\tif (!source.setType(type)) return;\r\n\t\t\t\tthis.effectState.protean = true;\r\n\t\t\t\tthis.add('-start', source, 'typechange', type, '[from] ability: Protean');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Protean\",\r\n\t\trating: 4,\r\n\t\tnum: 168,\r\n\t},\r\n\tprotosynthesis: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('WeatherChange', this.effect, this.effectState, pokemon);\r\n\t\t},\r\n\t\tonWeatherChange(pokemon) {\r\n\t\t\t// Protosynthesis is not affected by Utility Umbrella\r\n\t\t\tif (this.field.isWeather('sunnyday')) {\r\n\t\t\t\tpokemon.addVolatile('protosynthesis');\r\n\t\t\t} else if (!pokemon.volatiles['protosynthesis']?.fromBooster && !this.field.isWeather('sunnyday')) {\r\n\t\t\t\tpokemon.removeVolatile('protosynthesis');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tdelete pokemon.volatiles['protosynthesis'];\r\n\t\t\tthis.add('-end', pokemon, 'Protosynthesis', '[silent]');\r\n\t\t},\r\n\t\tcondition: {\r\n\t\t\tnoCopy: true,\r\n\t\t\tonStart(pokemon, source, effect) {\r\n\t\t\t\tif (effect?.name === 'Booster Energy') {\r\n\t\t\t\t\tthis.effectState.fromBooster = true;\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Protosynthesis', '[fromitem]');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Protosynthesis');\r\n\t\t\t\t}\r\n\t\t\t\tthis.effectState.bestStat = pokemon.getBestStat(false, true);\r\n\t\t\t\tthis.add('-start', pokemon, 'protosynthesis' + this.effectState.bestStat);\r\n\t\t\t},\r\n\t\t\tonModifyAtkPriority: 5,\r\n\t\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'atk' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Protosynthesis atk boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifyDefPriority: 6,\r\n\t\t\tonModifyDef(def, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'def' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Protosynthesis def boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpAPriority: 5,\r\n\t\t\tonModifySpA(spa, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spa' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Protosynthesis spa boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpDPriority: 6,\r\n\t\t\tonModifySpD(spd, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spd' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Protosynthesis spd boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpe(spe, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spe' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Protosynthesis spe boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t},\r\n\t\t\tonEnd(pokemon) {\r\n\t\t\t\tthis.add('-end', pokemon, 'Protosynthesis');\r\n\t\t\t},\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Protosynthesis\",\r\n\t\trating: 3,\r\n\t\tnum: 281,\r\n\t},\r\n\tpsychicsurge: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setTerrain('psychicterrain');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Psychic Surge\",\r\n\t\trating: 4,\r\n\t\tnum: 227,\r\n\t},\r\n\tpunkrock: {\r\n\t\tonBasePowerPriority: 7,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['sound']) {\r\n\t\t\t\tthis.debug('Punk Rock boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (move.flags['sound']) {\r\n\t\t\t\tthis.debug('Punk Rock weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Punk Rock\",\r\n\t\trating: 3.5,\r\n\t\tnum: 244,\r\n\t},\r\n\tpurepower: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk) {\r\n\t\t\treturn this.chainModify(2);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Pure Power\",\r\n\t\trating: 5,\r\n\t\tnum: 74,\r\n\t},\r\n\tpurifyingsalt: {\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Purifying Salt');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonTryAddVolatile(status, target) {\r\n\t\t\tif (status.id === 'yawn') {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Purifying Salt');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifyAtkPriority: 6,\r\n\t\tonSourceModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Ghost') {\r\n\t\t\t\tthis.debug('Purifying Salt weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifySpAPriority: 5,\r\n\t\tonSourceModifySpA(spa, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Ghost') {\r\n\t\t\t\tthis.debug('Purifying Salt weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Purifying Salt\",\r\n\t\trating: 4,\r\n\t\tnum: 272,\r\n\t},\r\n\tquarkdrive: {\r\n\t\tonSwitchInPriority: -2,\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.singleEvent('TerrainChange', this.effect, this.effectState, pokemon);\r\n\t\t},\r\n\t\tonTerrainChange(pokemon) {\r\n\t\t\tif (this.field.isTerrain('electricterrain')) {\r\n\t\t\t\tpokemon.addVolatile('quarkdrive');\r\n\t\t\t} else if (!pokemon.volatiles['quarkdrive']?.fromBooster) {\r\n\t\t\t\tpokemon.removeVolatile('quarkdrive');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tdelete pokemon.volatiles['quarkdrive'];\r\n\t\t\tthis.add('-end', pokemon, 'Quark Drive', '[silent]');\r\n\t\t},\r\n\t\tcondition: {\r\n\t\t\tnoCopy: true,\r\n\t\t\tonStart(pokemon, source, effect) {\r\n\t\t\t\tif (effect?.name === 'Booster Energy') {\r\n\t\t\t\t\tthis.effectState.fromBooster = true;\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Quark Drive', '[fromitem]');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Quark Drive');\r\n\t\t\t\t}\r\n\t\t\t\tthis.effectState.bestStat = pokemon.getBestStat(false, true);\r\n\t\t\t\tthis.add('-start', pokemon, 'quarkdrive' + this.effectState.bestStat);\r\n\t\t\t},\r\n\t\t\tonModifyAtkPriority: 5,\r\n\t\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'atk' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Quark Drive atk boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifyDefPriority: 6,\r\n\t\t\tonModifyDef(def, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'def' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Quark Drive def boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpAPriority: 5,\r\n\t\t\tonModifySpA(spa, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spa' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Quark Drive spa boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpDPriority: 6,\r\n\t\t\tonModifySpD(spd, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spd' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Quark Drive spd boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t},\r\n\t\t\tonModifySpe(spe, pokemon) {\r\n\t\t\t\tif (this.effectState.bestStat !== 'spe' || pokemon.ignoringAbility()) return;\r\n\t\t\t\tthis.debug('Quark Drive spe boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t},\r\n\t\t\tonEnd(pokemon) {\r\n\t\t\t\tthis.add('-end', pokemon, 'Quark Drive');\r\n\t\t\t},\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, notransform: 1 },\r\n\t\tname: \"Quark Drive\",\r\n\t\trating: 3,\r\n\t\tnum: 282,\r\n\t},\r\n\tqueenlymajesty: {\r\n\t\tonFoeTryMove(target, source, move) {\r\n\t\t\tconst targetAllExceptions = ['perishsong', 'flowershield', 'rototiller'];\r\n\t\t\tif (move.target === 'foeSide' || (move.target === 'all' && !targetAllExceptions.includes(move.id))) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst dazzlingHolder = this.effectState.target;\r\n\t\t\tif ((source.isAlly(dazzlingHolder) || move.target === 'all') && move.priority > 0.1) {\r\n\t\t\t\tthis.attrLastMove('[still]');\r\n\t\t\t\tthis.add('cant', dazzlingHolder, 'ability: Queenly Majesty', move, `[of] ${target}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Queenly Majesty\",\r\n\t\trating: 2.5,\r\n\t\tnum: 214,\r\n\t},\r\n\tquickdraw: {\r\n\t\tonFractionalPriorityPriority: -1,\r\n\t\tonFractionalPriority(priority, pokemon, target, move) {\r\n\t\t\tif (move.category !== \"Status\" && this.randomChance(3, 10)) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Quick Draw');\r\n\t\t\t\treturn 0.1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Quick Draw\",\r\n\t\trating: 2.5,\r\n\t\tnum: 259,\r\n\t},\r\n\tquickfeet: {\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (pokemon.status) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Quick Feet\",\r\n\t\trating: 2.5,\r\n\t\tnum: 95,\r\n\t},\r\n\traindish: {\r\n\t\tonWeather(target, source, effect) {\r\n\t\t\tif (target.hasItem('utilityumbrella')) return;\r\n\t\t\tif (effect.id === 'raindance' || effect.id === 'primordialsea') {\r\n\t\t\t\tthis.heal(target.baseMaxhp / 16);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rain Dish\",\r\n\t\trating: 1.5,\r\n\t\tnum: 44,\r\n\t},\r\n\trattled: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (['Dark', 'Bug', 'Ghost'].includes(move.type)) {\r\n\t\t\t\tthis.boost({ spe: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAfterBoost(boost, target, source, effect) {\r\n\t\t\tif (effect?.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tthis.boost({ spe: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rattled\",\r\n\t\trating: 1,\r\n\t\tnum: 155,\r\n\t},\r\n\treceiver: {\r\n\t\tonAllyFaint(target) {\r\n\t\t\tif (!this.effectState.target.hp) return;\r\n\t\t\tconst ability = target.getAbility();\r\n\t\t\tif (ability.flags['noreceiver'] || ability.id === 'noability') return;\r\n\t\t\tthis.effectState.target.setAbility(ability, target);\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1 },\r\n\t\tname: \"Receiver\",\r\n\t\trating: 0,\r\n\t\tnum: 222,\r\n\t},\r\n\treckless: {\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.recoil || move.hasCrashDamage) {\r\n\t\t\t\tthis.debug('Reckless boost');\r\n\t\t\t\treturn this.chainModify([4915, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Reckless\",\r\n\t\trating: 3,\r\n\t\tnum: 120,\r\n\t},\r\n\trefrigerate: {\r\n\t\tonModifyTypePriority: -1,\r\n\t\tonModifyType(move, pokemon) {\r\n\t\t\tconst noModifyType = [\r\n\t\t\t\t'judgment', 'multiattack', 'naturalgift', 'revelationdance', 'technoblast', 'terrainpulse', 'weatherball',\r\n\t\t\t];\r\n\t\t\tif (move.type === 'Normal' && (!noModifyType.includes(move.id) || this.activeMove?.isMax) &&\r\n\t\t\t\t!(move.isZ && move.category !== 'Status') && !(move.name === 'Tera Blast' && pokemon.terastallized)) {\r\n\t\t\t\tmove.type = 'Ice';\r\n\t\t\t\tmove.typeChangerBoosted = this.effect;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 23,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.typeChangerBoosted === this.effect) return this.chainModify([4915, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Refrigerate\",\r\n\t\trating: 4,\r\n\t\tnum: 174,\r\n\t},\r\n\tregenerator: {\r\n\t\tonSwitchOut(pokemon) {\r\n\t\t\tpokemon.heal(pokemon.baseMaxhp / 3);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Regenerator\",\r\n\t\trating: 4.5,\r\n\t\tnum: 144,\r\n\t},\r\n\tripen: {\r\n\t\tonTryHeal(damage, target, source, effect) {\r\n\t\t\tif (!effect) return;\r\n\t\t\tif (effect.name === 'Berry Juice' || effect.name === 'Leftovers') {\r\n\t\t\t\tthis.add('-activate', target, 'ability: Ripen');\r\n\t\t\t}\r\n\t\t\tif ((effect as Item).isBerry) return this.chainModify(2);\r\n\t\t},\r\n\t\tonChangeBoost(boost, target, source, effect) {\r\n\t\t\tif (effect && (effect as Item).isBerry) {\r\n\t\t\t\tlet b: BoostID;\r\n\t\t\t\tfor (b in boost) {\r\n\t\t\t\t\tboost[b]! *= 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifyDamagePriority: -1,\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.abilityState.berryWeaken) {\r\n\t\t\t\ttarget.abilityState.berryWeaken = false;\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryEatItemPriority: -1,\r\n\t\tonTryEatItem(item, pokemon) {\r\n\t\t\tthis.add('-activate', pokemon, 'ability: Ripen');\r\n\t\t},\r\n\t\tonEatItem(item, pokemon) {\r\n\t\t\tconst weakenBerries = [\r\n\t\t\t\t'Babiri Berry', 'Charti Berry', 'Chilan Berry', 'Chople Berry', 'Coba Berry', 'Colbur Berry', 'Haban Berry', 'Kasib Berry', 'Kebia Berry', 'Occa Berry', 'Passho Berry', 'Payapa Berry', 'Rindo Berry', 'Roseli Berry', 'Shuca Berry', 'Tanga Berry', 'Wacan Berry', 'Yache Berry',\r\n\t\t\t];\r\n\t\t\t// Record if the pokemon ate a berry to resist the attack\r\n\t\t\tpokemon.abilityState.berryWeaken = weakenBerries.includes(item.name);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Ripen\",\r\n\t\trating: 2,\r\n\t\tnum: 247,\r\n\t},\r\n\trivalry: {\r\n\t\tonBasePowerPriority: 24,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (attacker.gender && defender.gender) {\r\n\t\t\t\tif (attacker.gender === defender.gender) {\r\n\t\t\t\t\tthis.debug('Rivalry boost');\r\n\t\t\t\t\treturn this.chainModify(1.25);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.debug('Rivalry weaken');\r\n\t\t\t\t\treturn this.chainModify(0.75);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rivalry\",\r\n\t\trating: 0,\r\n\t\tnum: 79,\r\n\t},\r\n\trkssystem: {\r\n\t\t// RKS System's type-changing itself is implemented in statuses.js\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"RKS System\",\r\n\t\trating: 4,\r\n\t\tnum: 225,\r\n\t},\r\n\trockhead: {\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect.id === 'recoil') {\r\n\t\t\t\tif (!this.activeMove) throw new Error(\"Battle.activeMove is null\");\r\n\t\t\t\tif (this.activeMove.id !== 'struggle') return null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rock Head\",\r\n\t\trating: 3,\r\n\t\tnum: 69,\r\n\t},\r\n\trockypayload: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Rock') {\r\n\t\t\t\tthis.debug('Rocky Payload boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Rock') {\r\n\t\t\t\tthis.debug('Rocky Payload boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rocky Payload\",\r\n\t\trating: 3.5,\r\n\t\tnum: 276,\r\n\t},\r\n\troughskin: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, true)) {\r\n\t\t\t\tthis.damage(source.baseMaxhp / 8, source, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Rough Skin\",\r\n\t\trating: 2.5,\r\n\t\tnum: 24,\r\n\t},\r\n\trunaway: {\r\n\t\tflags: {},\r\n\t\tname: \"Run Away\",\r\n\t\trating: 0,\r\n\t\tnum: 50,\r\n\t},\r\n\tsandforce: {\r\n\t\tonBasePowerPriority: 21,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (this.field.isWeather('sandstorm')) {\r\n\t\t\t\tif (move.type === 'Rock' || move.type === 'Ground' || move.type === 'Steel') {\r\n\t\t\t\t\tthis.debug('Sand Force boost');\r\n\t\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'sandstorm') return false;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sand Force\",\r\n\t\trating: 2,\r\n\t\tnum: 159,\r\n\t},\r\n\tsandrush: {\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (this.field.isWeather('sandstorm')) {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'sandstorm') return false;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sand Rush\",\r\n\t\trating: 3,\r\n\t\tnum: 146,\r\n\t},\r\n\tsandspit: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tthis.field.setWeather('sandstorm');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sand Spit\",\r\n\t\trating: 1,\r\n\t\tnum: 245,\r\n\t},\r\n\tsandstream: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setWeather('sandstorm');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sand Stream\",\r\n\t\trating: 4,\r\n\t\tnum: 45,\r\n\t},\r\n\tsandveil: {\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'sandstorm') return false;\r\n\t\t},\r\n\t\tonModifyAccuracyPriority: -1,\r\n\t\tonModifyAccuracy(accuracy) {\r\n\t\t\tif (typeof accuracy !== 'number') return;\r\n\t\t\tif (this.field.isWeather('sandstorm')) {\r\n\t\t\t\tthis.debug('Sand Veil - decreasing accuracy');\r\n\t\t\t\treturn this.chainModify([3277, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Sand Veil\",\r\n\t\trating: 1.5,\r\n\t\tnum: 8,\r\n\t},\r\n\tsapsipper: {\r\n\t\tonTryHitPriority: 1,\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Grass') {\r\n\t\t\t\tif (!this.boost({ atk: 1 })) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Sap Sipper');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyTryHitSide(target, source, move) {\r\n\t\t\tif (source === this.effectState.target || !target.isAlly(source)) return;\r\n\t\t\tif (move.type === 'Grass') {\r\n\t\t\t\tthis.boost({ atk: 1 }, this.effectState.target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Sap Sipper\",\r\n\t\trating: 3,\r\n\t\tnum: 157,\r\n\t},\r\n\tschooling: {\r\n\t\tonSwitchInPriority: -1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Wishiwashi' || pokemon.level < 20 || pokemon.transformed) return;\r\n\t\t\tif (pokemon.hp > pokemon.maxhp / 4) {\r\n\t\t\t\tif (pokemon.species.id === 'wishiwashi') {\r\n\t\t\t\t\tpokemon.formeChange('Wishiwashi-School');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (pokemon.species.id === 'wishiwashischool') {\r\n\t\t\t\t\tpokemon.formeChange('Wishiwashi');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (\r\n\t\t\t\tpokemon.baseSpecies.baseSpecies !== 'Wishiwashi' || pokemon.level < 20 ||\r\n\t\t\t\tpokemon.transformed || !pokemon.hp\r\n\t\t\t) return;\r\n\t\t\tif (pokemon.hp > pokemon.maxhp / 4) {\r\n\t\t\t\tif (pokemon.species.id === 'wishiwashi') {\r\n\t\t\t\t\tpokemon.formeChange('Wishiwashi-School');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (pokemon.species.id === 'wishiwashischool') {\r\n\t\t\t\t\tpokemon.formeChange('Wishiwashi');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Schooling\",\r\n\t\trating: 3,\r\n\t\tnum: 208,\r\n\t},\r\n\tscrappy: {\r\n\t\tonModifyMovePriority: -5,\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (!move.ignoreImmunity) move.ignoreImmunity = {};\r\n\t\t\tif (move.ignoreImmunity !== true) {\r\n\t\t\t\tmove.ignoreImmunity['Fighting'] = true;\r\n\t\t\t\tmove.ignoreImmunity['Normal'] = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (effect.name === 'Intimidate' && boost.atk) {\r\n\t\t\t\tdelete boost.atk;\r\n\t\t\t\tthis.add('-fail', target, 'unboost', 'Attack', '[from] ability: Scrappy', `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Scrappy\",\r\n\t\trating: 3,\r\n\t\tnum: 113,\r\n\t},\r\n\tscreencleaner: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tlet activated = false;\r\n\t\t\tfor (const sideCondition of ['reflect', 'lightscreen', 'auroraveil']) {\r\n\t\t\t\tfor (const side of [pokemon.side, ...pokemon.side.foeSidesWithConditions()]) {\r\n\t\t\t\t\tif (side.getSideCondition(sideCondition)) {\r\n\t\t\t\t\t\tif (!activated) {\r\n\t\t\t\t\t\t\tthis.add('-activate', pokemon, 'ability: Screen Cleaner');\r\n\t\t\t\t\t\t\tactivated = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tside.removeSideCondition(sideCondition);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Screen Cleaner\",\r\n\t\trating: 2,\r\n\t\tnum: 251,\r\n\t},\r\n\tseedsower: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tthis.field.setTerrain('grassyterrain');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Seed Sower\",\r\n\t\trating: 2.5,\r\n\t\tnum: 269,\r\n\t},\r\n\tserenegrace: {\r\n\t\tonModifyMovePriority: -2,\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (move.secondaries) {\r\n\t\t\t\tthis.debug('doubling secondary chance');\r\n\t\t\t\tfor (const secondary of move.secondaries) {\r\n\t\t\t\t\tif (secondary.chance) secondary.chance *= 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (move.self?.chance) move.self.chance *= 2;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Serene Grace\",\r\n\t\trating: 3.5,\r\n\t\tnum: 32,\r\n\t},\r\n\tshadowshield: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.hp >= target.maxhp) {\r\n\t\t\t\tthis.debug('Shadow Shield weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Shadow Shield\",\r\n\t\trating: 3.5,\r\n\t\tnum: 231,\r\n\t},\r\n\tshadowtag: {\r\n\t\tonFoeTrapPokemon(pokemon) {\r\n\t\t\tif (!pokemon.hasAbility('shadowtag') && pokemon.isAdjacent(this.effectState.target)) {\r\n\t\t\t\tpokemon.tryTrap(true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonFoeMaybeTrapPokemon(pokemon, source) {\r\n\t\t\tif (!source) source = this.effectState.target;\r\n\t\t\tif (!source || !pokemon.isAdjacent(source)) return;\r\n\t\t\tif (!pokemon.hasAbility('shadowtag')) {\r\n\t\t\t\tpokemon.maybeTrapped = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Shadow Tag\",\r\n\t\trating: 5,\r\n\t\tnum: 23,\r\n\t},\r\n\tsharpness: {\r\n\t\tonBasePowerPriority: 19,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['slicing']) {\r\n\t\t\t\tthis.debug('Sharpness boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sharpness\",\r\n\t\trating: 3.5,\r\n\t\tnum: 292,\r\n\t},\r\n\tshedskin: {\r\n\t\tonResidualOrder: 5,\r\n\t\tonResidualSubOrder: 3,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.hp && pokemon.status && this.randomChance(33, 100)) {\r\n\t\t\t\tthis.debug('shed skin');\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Shed Skin');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Shed Skin\",\r\n\t\trating: 3,\r\n\t\tnum: 61,\r\n\t},\r\n\tsheerforce: {\r\n\t\tonModifyMove(move, pokemon) {\r\n\t\t\tif (move.secondaries) {\r\n\t\t\t\tdelete move.secondaries;\r\n\t\t\t\t// Technically not a secondary effect, but it is negated\r\n\t\t\t\tdelete move.self;\r\n\t\t\t\tif (move.id === 'clangoroussoulblaze') delete move.selfBoost;\r\n\t\t\t\t// Actual negation of `AfterMoveSecondary` effects implemented in scripts.js\r\n\t\t\t\tmove.hasSheerForce = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBasePowerPriority: 21,\r\n\t\tonBasePower(basePower, pokemon, target, move) {\r\n\t\t\tif (move.hasSheerForce) return this.chainModify([5325, 4096]);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sheer Force\",\r\n\t\trating: 3.5,\r\n\t\tnum: 125,\r\n\t},\r\n\tshellarmor: {\r\n\t\tonCriticalHit: false,\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Shell Armor\",\r\n\t\trating: 1,\r\n\t\tnum: 75,\r\n\t},\r\n\tshielddust: {\r\n\t\tonModifySecondaries(secondaries) {\r\n\t\t\tthis.debug('Shield Dust prevent secondary');\r\n\t\t\treturn secondaries.filter(effect => !!effect.self);\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Shield Dust\",\r\n\t\trating: 2,\r\n\t\tnum: 19,\r\n\t},\r\n\tshieldsdown: {\r\n\t\tonSwitchInPriority: -1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Minior' || pokemon.transformed) return;\r\n\t\t\tif (pokemon.hp > pokemon.maxhp / 2) {\r\n\t\t\t\tif (pokemon.species.forme !== 'Meteor') {\r\n\t\t\t\t\tpokemon.formeChange('Minior-Meteor');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (pokemon.species.forme === 'Meteor') {\r\n\t\t\t\t\tpokemon.formeChange(pokemon.set.species);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Minior' || pokemon.transformed || !pokemon.hp) return;\r\n\t\t\tif (pokemon.hp > pokemon.maxhp / 2) {\r\n\t\t\t\tif (pokemon.species.forme !== 'Meteor') {\r\n\t\t\t\t\tpokemon.formeChange('Minior-Meteor');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (pokemon.species.forme === 'Meteor') {\r\n\t\t\t\t\tpokemon.formeChange(pokemon.set.species);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (target.species.id !== 'miniormeteor' || target.transformed) return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Shields Down');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonTryAddVolatile(status, target) {\r\n\t\t\tif (target.species.id !== 'miniormeteor' || target.transformed) return;\r\n\t\t\tif (status.id !== 'yawn') return;\r\n\t\t\tthis.add('-immune', target, '[from] ability: Shields Down');\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Shields Down\",\r\n\t\trating: 3,\r\n\t\tnum: 197,\r\n\t},\r\n\tsimple: {\r\n\t\tonChangeBoost(boost, target, source, effect) {\r\n\t\t\tif (effect && effect.id === 'zpower') return;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tboost[i]! *= 2;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Simple\",\r\n\t\trating: 4,\r\n\t\tnum: 86,\r\n\t},\r\n\tskilllink: {\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (move.multihit && Array.isArray(move.multihit) && move.multihit.length) {\r\n\t\t\t\tmove.multihit = move.multihit[1];\r\n\t\t\t}\r\n\t\t\tif (move.multiaccuracy) {\r\n\t\t\t\tdelete move.multiaccuracy;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Skill Link\",\r\n\t\trating: 3,\r\n\t\tnum: 92,\r\n\t},\r\n\tslowstart: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-start', pokemon, 'ability: Slow Start');\r\n\t\t\tthis.effectState.counter = 5;\r\n\t\t},\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.activeTurns && this.effectState.counter) {\r\n\t\t\t\tthis.effectState.counter--;\r\n\t\t\t\tif (!this.effectState.counter) {\r\n\t\t\t\t\tthis.add('-end', pokemon, 'Slow Start');\r\n\t\t\t\t\tdelete this.effectState.counter;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, pokemon) {\r\n\t\t\tif (this.effectState.counter) {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (this.effectState.counter) {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Slow Start\",\r\n\t\trating: -1,\r\n\t\tnum: 112,\r\n\t},\r\n\tslushrush: {\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (this.field.isWeather(['hail', 'snowscape'])) {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Slush Rush\",\r\n\t\trating: 3,\r\n\t\tnum: 202,\r\n\t},\r\n\tsniper: {\r\n\t\tonModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.getMoveHitData(move).crit) {\r\n\t\t\t\tthis.debug('Sniper boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sniper\",\r\n\t\trating: 2,\r\n\t\tnum: 97,\r\n\t},\r\n\tsnowcloak: {\r\n\t\tonImmunity(type, pokemon) {\r\n\t\t\tif (type === 'hail') return false;\r\n\t\t},\r\n\t\tonModifyAccuracyPriority: -1,\r\n\t\tonModifyAccuracy(accuracy) {\r\n\t\t\tif (typeof accuracy !== 'number') return;\r\n\t\t\tif (this.field.isWeather(['hail', 'snowscape'])) {\r\n\t\t\t\tthis.debug('Snow Cloak - decreasing accuracy');\r\n\t\t\t\treturn this.chainModify([3277, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Snow Cloak\",\r\n\t\trating: 1.5,\r\n\t\tnum: 81,\r\n\t},\r\n\tsnowwarning: {\r\n\t\tonStart(source) {\r\n\t\t\tthis.field.setWeather('snowscape');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Snow Warning\",\r\n\t\trating: 4,\r\n\t\tnum: 117,\r\n\t},\r\n\tsolarpower: {\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(spa, pokemon) {\r\n\t\t\tif (['sunnyday', 'desolateland'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonWeather(target, source, effect) {\r\n\t\t\tif (target.hasItem('utilityumbrella')) return;\r\n\t\t\tif (effect.id === 'sunnyday' || effect.id === 'desolateland') {\r\n\t\t\t\tthis.damage(target.baseMaxhp / 8, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Solar Power\",\r\n\t\trating: 2,\r\n\t\tnum: 94,\r\n\t},\r\n\tsolidrock: {\r\n\t\tonSourceModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.getMoveHitData(move).typeMod > 0) {\r\n\t\t\t\tthis.debug('Solid Rock neutralize');\r\n\t\t\t\treturn this.chainModify(0.75);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Solid Rock\",\r\n\t\trating: 3,\r\n\t\tnum: 116,\r\n\t},\r\n\tsoulheart: {\r\n\t\tonAnyFaintPriority: 1,\r\n\t\tonAnyFaint() {\r\n\t\t\tthis.boost({ spa: 1 }, this.effectState.target);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Soul-Heart\",\r\n\t\trating: 3.5,\r\n\t\tnum: 220,\r\n\t},\r\n\tsoundproof: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.flags['sound']) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Soundproof');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyTryHitSide(target, source, move) {\r\n\t\t\tif (move.flags['sound']) {\r\n\t\t\t\tthis.add('-immune', this.effectState.target, '[from] ability: Soundproof');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Soundproof\",\r\n\t\trating: 2,\r\n\t\tnum: 43,\r\n\t},\r\n\tspeedboost: {\r\n\t\tonResidualOrder: 28,\r\n\t\tonResidualSubOrder: 2,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.activeTurns) {\r\n\t\t\t\tthis.boost({ spe: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Speed Boost\",\r\n\t\trating: 4.5,\r\n\t\tnum: 3,\r\n\t},\r\n\tstakeout: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender) {\r\n\t\t\tif (!defender.activeTurns) {\r\n\t\t\t\tthis.debug('Stakeout boost');\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender) {\r\n\t\t\tif (!defender.activeTurns) {\r\n\t\t\t\tthis.debug('Stakeout boost');\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Stakeout\",\r\n\t\trating: 4.5,\r\n\t\tnum: 198,\r\n\t},\r\n\tstall: {\r\n\t\tonFractionalPriority: -0.1,\r\n\t\tflags: {},\r\n\t\tname: \"Stall\",\r\n\t\trating: -1,\r\n\t\tnum: 100,\r\n\t},\r\n\tstalwart: {\r\n\t\tonModifyMovePriority: 1,\r\n\t\tonModifyMove(move) {\r\n\t\t\t// most of the implementation is in Battle#getTarget\r\n\t\t\tmove.tracksTarget = move.target !== 'scripted';\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Stalwart\",\r\n\t\trating: 0,\r\n\t\tnum: 242,\r\n\t},\r\n\tstamina: {\r\n\t\tonDamagingHit(damage, target, source, effect) {\r\n\t\t\tthis.boost({ def: 1 });\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Stamina\",\r\n\t\trating: 4,\r\n\t\tnum: 192,\r\n\t},\r\n\tstancechange: {\r\n\t\tonModifyMovePriority: 1,\r\n\t\tonModifyMove(move, attacker, defender) {\r\n\t\t\tif (attacker.species.baseSpecies !== 'Aegislash' || attacker.transformed) return;\r\n\t\t\tif (move.category === 'Status' && move.id !== 'kingsshield') return;\r\n\t\t\tconst targetForme = (move.id === 'kingsshield' ? 'Aegislash' : 'Aegislash-Blade');\r\n\t\t\tif (attacker.species.name !== targetForme) attacker.formeChange(targetForme);\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Stance Change\",\r\n\t\trating: 4,\r\n\t\tnum: 176,\r\n\t},\r\n\tstatic: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target)) {\r\n\t\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\t\tsource.trySetStatus('par', target);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Static\",\r\n\t\trating: 2,\r\n\t\tnum: 9,\r\n\t},\r\n\tsteadfast: {\r\n\t\tonFlinch(pokemon) {\r\n\t\t\tthis.boost({ spe: 1 });\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Steadfast\",\r\n\t\trating: 1,\r\n\t\tnum: 80,\r\n\t},\r\n\tsteamengine: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (['Water', 'Fire'].includes(move.type)) {\r\n\t\t\t\tthis.boost({ spe: 6 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Steam Engine\",\r\n\t\trating: 2,\r\n\t\tnum: 243,\r\n\t},\r\n\tsteelworker: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Steel') {\r\n\t\t\t\tthis.debug('Steelworker boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Steel') {\r\n\t\t\t\tthis.debug('Steelworker boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Steelworker\",\r\n\t\trating: 3.5,\r\n\t\tnum: 200,\r\n\t},\r\n\tsteelyspirit: {\r\n\t\tonAllyBasePowerPriority: 22,\r\n\t\tonAllyBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Steel') {\r\n\t\t\t\tthis.debug('Steely Spirit boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Steely Spirit\",\r\n\t\trating: 3.5,\r\n\t\tnum: 252,\r\n\t},\r\n\tstench: {\r\n\t\tonModifyMovePriority: -1,\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (move.category !== \"Status\") {\r\n\t\t\t\tthis.debug('Adding Stench flinch');\r\n\t\t\t\tif (!move.secondaries) move.secondaries = [];\r\n\t\t\t\tfor (const secondary of move.secondaries) {\r\n\t\t\t\t\tif (secondary.volatileStatus === 'flinch') return;\r\n\t\t\t\t}\r\n\t\t\t\tmove.secondaries.push({\r\n\t\t\t\t\tchance: 10,\r\n\t\t\t\t\tvolatileStatus: 'flinch',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Stench\",\r\n\t\trating: 0.5,\r\n\t\tnum: 1,\r\n\t},\r\n\tstickyhold: {\r\n\t\tonTakeItem(item, pokemon, source) {\r\n\t\t\tif (!this.activeMove) throw new Error(\"Battle.activeMove is null\");\r\n\t\t\tif (!pokemon.hp || pokemon.item === 'stickybarb') return;\r\n\t\t\tif ((source && source !== pokemon) || this.activeMove.id === 'knockoff') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Sticky Hold');\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Sticky Hold\",\r\n\t\trating: 1.5,\r\n\t\tnum: 60,\r\n\t},\r\n\tstormdrain: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Water') {\r\n\t\t\t\tif (!this.boost({ spa: 1 })) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Storm Drain');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAnyRedirectTarget(target, source, source2, move) {\r\n\t\t\tif (move.type !== 'Water' || move.flags['pledgecombo']) return;\r\n\t\t\tconst redirectTarget = ['randomNormal', 'adjacentFoe'].includes(move.target) ? 'normal' : move.target;\r\n\t\t\tif (this.validTarget(this.effectState.target, source, redirectTarget)) {\r\n\t\t\t\tif (move.smartTarget) move.smartTarget = false;\r\n\t\t\t\tif (this.effectState.target !== target) {\r\n\t\t\t\t\tthis.add('-activate', this.effectState.target, 'ability: Storm Drain');\r\n\t\t\t\t}\r\n\t\t\t\treturn this.effectState.target;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Storm Drain\",\r\n\t\trating: 3,\r\n\t\tnum: 114,\r\n\t},\r\n\tstrongjaw: {\r\n\t\tonBasePowerPriority: 19,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['bite']) {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Strong Jaw\",\r\n\t\trating: 3.5,\r\n\t\tnum: 173,\r\n\t},\r\n\tsturdy: {\r\n\t\tonTryHit(pokemon, target, move) {\r\n\t\t\tif (move.ohko) {\r\n\t\t\t\tthis.add('-immune', pokemon, '[from] ability: Sturdy');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDamagePriority: -30,\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (target.hp === target.maxhp && damage >= target.hp && effect && effect.effectType === 'Move') {\r\n\t\t\t\tthis.add('-ability', target, 'Sturdy');\r\n\t\t\t\treturn target.hp - 1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Sturdy\",\r\n\t\trating: 3,\r\n\t\tnum: 5,\r\n\t},\r\n\tsuctioncups: {\r\n\t\tonDragOutPriority: 1,\r\n\t\tonDragOut(pokemon) {\r\n\t\t\tthis.add('-activate', pokemon, 'ability: Suction Cups');\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Suction Cups\",\r\n\t\trating: 1,\r\n\t\tnum: 21,\r\n\t},\r\n\tsuperluck: {\r\n\t\tonModifyCritRatio(critRatio) {\r\n\t\t\treturn critRatio + 1;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Super Luck\",\r\n\t\trating: 1.5,\r\n\t\tnum: 105,\r\n\t},\r\n\tsupersweetsyrup: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.syrupTriggered) return;\r\n\t\t\tpokemon.syrupTriggered = true;\r\n\t\t\tthis.add('-ability', pokemon, 'Supersweet Syrup');\r\n\t\t\tfor (const target of pokemon.adjacentFoes()) {\r\n\t\t\t\tif (target.volatiles['substitute']) {\r\n\t\t\t\t\tthis.add('-immune', target);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.boost({ evasion: -1 }, target, pokemon, null, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Supersweet Syrup\",\r\n\t\trating: 1.5,\r\n\t\tnum: 306,\r\n\t},\r\n\tsupremeoverlord: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.side.totalFainted) {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Supreme Overlord');\r\n\t\t\t\tconst fallen = Math.min(pokemon.side.totalFainted, 5);\r\n\t\t\t\tthis.add('-start', pokemon, `fallen${fallen}`, '[silent]');\r\n\t\t\t\tthis.effectState.fallen = fallen;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tthis.add('-end', pokemon, `fallen${this.effectState.fallen}`, '[silent]');\r\n\t\t},\r\n\t\tonBasePowerPriority: 21,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (this.effectState.fallen) {\r\n\t\t\t\tconst powMod = [4096, 4506, 4915, 5325, 5734, 6144];\r\n\t\t\t\tthis.debug(`Supreme Overlord boost: ${powMod[this.effectState.fallen]}/4096`);\r\n\t\t\t\treturn this.chainModify([powMod[this.effectState.fallen], 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Supreme Overlord\",\r\n\t\trating: 4,\r\n\t\tnum: 293,\r\n\t},\r\n\tsurgesurfer: {\r\n\t\tonModifySpe(spe) {\r\n\t\t\tif (this.field.isTerrain('electricterrain')) {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Surge Surfer\",\r\n\t\trating: 3,\r\n\t\tnum: 207,\r\n\t},\r\n\tswarm: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Bug' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Swarm boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Bug' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Swarm boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Swarm\",\r\n\t\trating: 2,\r\n\t\tnum: 68,\r\n\t},\r\n\tsweetveil: {\r\n\t\tonAllySetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id === 'slp') {\r\n\t\t\t\tthis.debug('Sweet Veil interrupts sleep');\r\n\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\tthis.add('-block', target, 'ability: Sweet Veil', `[of] ${effectHolder}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonAllyTryAddVolatile(status, target) {\r\n\t\t\tif (status.id === 'yawn') {\r\n\t\t\t\tthis.debug('Sweet Veil blocking yawn');\r\n\t\t\t\tconst effectHolder = this.effectState.target;\r\n\t\t\t\tthis.add('-block', target, 'ability: Sweet Veil', `[of] ${effectHolder}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Sweet Veil\",\r\n\t\trating: 2,\r\n\t\tnum: 175,\r\n\t},\r\n\tswiftswim: {\r\n\t\tonModifySpe(spe, pokemon) {\r\n\t\t\tif (['raindance', 'primordialsea'].includes(pokemon.effectiveWeather())) {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Swift Swim\",\r\n\t\trating: 3,\r\n\t\tnum: 33,\r\n\t},\r\n\tsymbiosis: {\r\n\t\tonAllyAfterUseItem(item, pokemon) {\r\n\t\t\tif (pokemon.switchFlag) return;\r\n\t\t\tconst source = this.effectState.target;\r\n\t\t\tconst myItem = source.takeItem();\r\n\t\t\tif (!myItem) return;\r\n\t\t\tif (\r\n\t\t\t\t!this.singleEvent('TakeItem', myItem, source.itemState, pokemon, source, this.effect, myItem) ||\r\n\t\t\t\t!pokemon.setItem(myItem)\r\n\t\t\t) {\r\n\t\t\t\tsource.item = myItem.id;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.add('-activate', source, 'ability: Symbiosis', myItem, `[of] ${pokemon}`);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Symbiosis\",\r\n\t\trating: 0,\r\n\t\tnum: 180,\r\n\t},\r\n\tsynchronize: {\r\n\t\tonAfterSetStatus(status, target, source, effect) {\r\n\t\t\tif (!source || source === target) return;\r\n\t\t\tif (effect && effect.id === 'toxicspikes') return;\r\n\t\t\tif (status.id === 'slp' || status.id === 'frz') return;\r\n\t\t\tthis.add('-activate', target, 'ability: Synchronize');\r\n\t\t\t// Hack to make status-prevention abilities think Synchronize is a status move\r\n\t\t\t// and show messages when activating against it.\r\n\t\t\tsource.trySetStatus(status, target, { status: status.id, id: 'synchronize' } as Effect);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Synchronize\",\r\n\t\trating: 2,\r\n\t\tnum: 28,\r\n\t},\r\n\tswordofruin: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Sword of Ruin');\r\n\t\t},\r\n\t\tonAnyModifyDef(def, target, source, move) {\r\n\t\t\tconst abilityHolder = this.effectState.target;\r\n\t\t\tif (target.hasAbility('Sword of Ruin')) return;\r\n\t\t\tif (!move.ruinedDef?.hasAbility('Sword of Ruin')) move.ruinedDef = abilityHolder;\r\n\t\t\tif (move.ruinedDef !== abilityHolder) return;\r\n\t\t\tthis.debug('Sword of Ruin Def drop');\r\n\t\t\treturn this.chainModify(0.75);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Sword of Ruin\",\r\n\t\trating: 4.5,\r\n\t\tnum: 285,\r\n\t},\r\n\ttabletsofruin: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Tablets of Ruin');\r\n\t\t},\r\n\t\tonAnyModifyAtk(atk, source, target, move) {\r\n\t\t\tconst abilityHolder = this.effectState.target;\r\n\t\t\tif (source.hasAbility('Tablets of Ruin')) return;\r\n\t\t\tif (!move.ruinedAtk) move.ruinedAtk = abilityHolder;\r\n\t\t\tif (move.ruinedAtk !== abilityHolder) return;\r\n\t\t\tthis.debug('Tablets of Ruin Atk drop');\r\n\t\t\treturn this.chainModify(0.75);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Tablets of Ruin\",\r\n\t\trating: 4.5,\r\n\t\tnum: 284,\r\n\t},\r\n\ttangledfeet: {\r\n\t\tonModifyAccuracyPriority: -1,\r\n\t\tonModifyAccuracy(accuracy, target) {\r\n\t\t\tif (typeof accuracy !== 'number') return;\r\n\t\t\tif (target?.volatiles['confusion']) {\r\n\t\t\t\tthis.debug('Tangled Feet - decreasing accuracy');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Tangled Feet\",\r\n\t\trating: 1,\r\n\t\tnum: 77,\r\n\t},\r\n\ttanglinghair: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target, true)) {\r\n\t\t\t\tthis.add('-ability', target, 'Tangling Hair');\r\n\t\t\t\tthis.boost({ spe: -1 }, source, target, null, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Tangling Hair\",\r\n\t\trating: 2,\r\n\t\tnum: 221,\r\n\t},\r\n\ttechnician: {\r\n\t\tonBasePowerPriority: 30,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tconst basePowerAfterMultiplier = this.modify(basePower, this.event.modifier);\r\n\t\t\tthis.debug(`Base Power: ${basePowerAfterMultiplier}`);\r\n\t\t\tif (basePowerAfterMultiplier <= 60) {\r\n\t\t\t\tthis.debug('Technician boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Technician\",\r\n\t\trating: 3.5,\r\n\t\tnum: 101,\r\n\t},\r\n\ttelepathy: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && target.isAlly(source) && move.category !== 'Status') {\r\n\t\t\t\tthis.add('-activate', target, 'ability: Telepathy');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Telepathy\",\r\n\t\trating: 0,\r\n\t\tnum: 140,\r\n\t},\r\n\tteraformzero: {\r\n\t\tonAfterTerastallization(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.name !== 'Terapagos-Stellar') return;\r\n\t\t\tif (this.field.weather || this.field.terrain) {\r\n\t\t\t\tthis.add('-ability', pokemon, 'Teraform Zero');\r\n\t\t\t\tthis.field.clearWeather();\r\n\t\t\t\tthis.field.clearTerrain();\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1 },\r\n\t\tname: \"Teraform Zero\",\r\n\t\trating: 3,\r\n\t\tnum: 309,\r\n\t},\r\n\tterashell: {\r\n\t\t// effectiveness implemented in sim/pokemon.ts:Pokemon#runEffectiveness\r\n\t\t// needs two checks to reset between regular moves and future attacks\r\n\t\tonAnyBeforeMove() {\r\n\t\t\tdelete this.effectState.resisted;\r\n\t\t},\r\n\t\tonAnyAfterMove() {\r\n\t\t\tdelete this.effectState.resisted;\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, breakable: 1 },\r\n\t\tname: \"Tera Shell\",\r\n\t\trating: 3.5,\r\n\t\tnum: 308,\r\n\t},\r\n\tterashift: {\r\n\t\tonSwitchInPriority: 2,\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Terapagos') return;\r\n\t\t\tif (pokemon.species.forme !== 'Terastal') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Tera Shift');\r\n\t\t\t\tpokemon.formeChange('Terapagos-Terastal', this.effect, true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1, notransform: 1 },\r\n\t\tname: \"Tera Shift\",\r\n\t\trating: 3,\r\n\t\tnum: 307,\r\n\t},\r\n\tteravolt: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Teravolt');\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreAbility = true;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Teravolt\",\r\n\t\trating: 3,\r\n\t\tnum: 164,\r\n\t},\r\n\tthermalexchange: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\tthis.boost({ atk: 1 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'brn') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Thermal Exchange');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'brn') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Thermal Exchange');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Thermal Exchange\",\r\n\t\trating: 2.5,\r\n\t\tnum: 270,\r\n\t},\r\n\tthickfat: {\r\n\t\tonSourceModifyAtkPriority: 6,\r\n\t\tonSourceModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Ice' || move.type === 'Fire') {\r\n\t\t\t\tthis.debug('Thick Fat weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifySpAPriority: 5,\r\n\t\tonSourceModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Ice' || move.type === 'Fire') {\r\n\t\t\t\tthis.debug('Thick Fat weaken');\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Thick Fat\",\r\n\t\trating: 3.5,\r\n\t\tnum: 47,\r\n\t},\r\n\ttintedlens: {\r\n\t\tonModifyDamage(damage, source, target, move) {\r\n\t\t\tif (target.getMoveHitData(move).typeMod < 0) {\r\n\t\t\t\tthis.debug('Tinted Lens boost');\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Tinted Lens\",\r\n\t\trating: 4,\r\n\t\tnum: 110,\r\n\t},\r\n\ttorrent: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Water' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Torrent boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Water' && attacker.hp <= attacker.maxhp / 3) {\r\n\t\t\t\tthis.debug('Torrent boost');\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Torrent\",\r\n\t\trating: 2,\r\n\t\tnum: 67,\r\n\t},\r\n\ttoughclaws: {\r\n\t\tonBasePowerPriority: 21,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif (move.flags['contact']) {\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Tough Claws\",\r\n\t\trating: 3.5,\r\n\t\tnum: 181,\r\n\t},\r\n\ttoxicboost: {\r\n\t\tonBasePowerPriority: 19,\r\n\t\tonBasePower(basePower, attacker, defender, move) {\r\n\t\t\tif ((attacker.status === 'psn' || attacker.status === 'tox') && move.category === 'Physical') {\r\n\t\t\t\treturn this.chainModify(1.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Toxic Boost\",\r\n\t\trating: 3,\r\n\t\tnum: 137,\r\n\t},\r\n\ttoxicchain: {\r\n\t\tonSourceDamagingHit(damage, target, source, move) {\r\n\t\t\t// Despite not being a secondary, Shield Dust / Covert Cloak block Toxic Chain's effect\r\n\t\t\tif (target.hasAbility('shielddust') || target.hasItem('covertcloak')) return;\r\n\r\n\t\t\tif (this.randomChance(3, 10)) {\r\n\t\t\t\ttarget.trySetStatus('tox', source);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Toxic Chain\",\r\n\t\trating: 4.5,\r\n\t\tnum: 305,\r\n\t},\r\n\ttoxicdebris: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tconst side = source.isAlly(target) ? source.side.foe : source.side;\r\n\t\t\tconst toxicSpikes = side.sideConditions['toxicspikes'];\r\n\t\t\tif (move.category === 'Physical' && (!toxicSpikes || toxicSpikes.layers < 2)) {\r\n\t\t\t\tthis.add('-activate', target, 'ability: Toxic Debris');\r\n\t\t\t\tside.addSideCondition('toxicspikes', target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Toxic Debris\",\r\n\t\trating: 3.5,\r\n\t\tnum: 295,\r\n\t},\r\n\ttrace: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.effectState.seek = true;\r\n\t\t\t// n.b. only affects Hackmons\r\n\t\t\t// interaction with No Ability is complicated: https://www.smogon.com/forums/threads/pokemon-sun-moon-battle-mechanics-research.3586701/page-76#post-7790209\r\n\t\t\tif (pokemon.adjacentFoes().some(foeActive => foeActive.ability === 'noability')) {\r\n\t\t\t\tthis.effectState.seek = false;\r\n\t\t\t}\r\n\t\t\t// interaction with Ability Shield is similar to No Ability\r\n\t\t\tif (pokemon.hasItem('Ability Shield')) {\r\n\t\t\t\tthis.add('-block', pokemon, 'item: Ability Shield');\r\n\t\t\t\tthis.effectState.seek = false;\r\n\t\t\t}\r\n\t\t\tif (this.effectState.seek) {\r\n\t\t\t\tthis.singleEvent('Update', this.effect, this.effectState, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (!this.effectState.seek) return;\r\n\r\n\t\t\tconst possibleTargets = pokemon.adjacentFoes().filter(\r\n\t\t\t\ttarget => !target.getAbility().flags['notrace'] && target.ability !== 'noability'\r\n\t\t\t);\r\n\t\t\tif (!possibleTargets.length) return;\r\n\r\n\t\t\tconst target = this.sample(possibleTargets);\r\n\t\t\tconst ability = target.getAbility();\r\n\t\t\tpokemon.setAbility(ability, target);\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1 },\r\n\t\tname: \"Trace\",\r\n\t\trating: 2.5,\r\n\t\tnum: 36,\r\n\t},\r\n\ttransistor: {\r\n\t\tonModifyAtkPriority: 5,\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Electric') {\r\n\t\t\t\tthis.debug('Transistor boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpAPriority: 5,\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Electric') {\r\n\t\t\t\tthis.debug('Transistor boost');\r\n\t\t\t\treturn this.chainModify([5325, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Transistor\",\r\n\t\trating: 3.5,\r\n\t\tnum: 262,\r\n\t},\r\n\ttriage: {\r\n\t\tonModifyPriority(priority, pokemon, target, move) {\r\n\t\t\tif (move?.flags['heal']) return priority + 3;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Triage\",\r\n\t\trating: 3.5,\r\n\t\tnum: 205,\r\n\t},\r\n\ttruant: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tpokemon.removeVolatile('truant');\r\n\t\t\tif (pokemon.activeTurns && (pokemon.moveThisTurnResult !== undefined || !this.queue.willMove(pokemon))) {\r\n\t\t\t\tpokemon.addVolatile('truant');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBeforeMovePriority: 9,\r\n\t\tonBeforeMove(pokemon) {\r\n\t\t\tif (pokemon.removeVolatile('truant')) {\r\n\t\t\t\tthis.add('cant', pokemon, 'ability: Truant');\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tpokemon.addVolatile('truant');\r\n\t\t},\r\n\t\tcondition: {},\r\n\t\tflags: {},\r\n\t\tname: \"Truant\",\r\n\t\trating: -1,\r\n\t\tnum: 54,\r\n\t},\r\n\tturboblaze: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tthis.add('-ability', pokemon, 'Turboblaze');\r\n\t\t},\r\n\t\tonModifyMove(move) {\r\n\t\t\tmove.ignoreAbility = true;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Turboblaze\",\r\n\t\trating: 3,\r\n\t\tnum: 163,\r\n\t},\r\n\tunaware: {\r\n\t\tonAnyModifyBoost(boosts, pokemon) {\r\n\t\t\tconst unawareUser = this.effectState.target;\r\n\t\t\tif (unawareUser === pokemon) return;\r\n\t\t\tif (unawareUser === this.activePokemon && pokemon === this.activeTarget) {\r\n\t\t\t\tboosts['def'] = 0;\r\n\t\t\t\tboosts['spd'] = 0;\r\n\t\t\t\tboosts['evasion'] = 0;\r\n\t\t\t}\r\n\t\t\tif (pokemon === this.activePokemon && unawareUser === this.activeTarget) {\r\n\t\t\t\tboosts['atk'] = 0;\r\n\t\t\t\tboosts['def'] = 0;\r\n\t\t\t\tboosts['spa'] = 0;\r\n\t\t\t\tboosts['accuracy'] = 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Unaware\",\r\n\t\trating: 4,\r\n\t\tnum: 109,\r\n\t},\r\n\tunburden: {\r\n\t\tonAfterUseItem(item, pokemon) {\r\n\t\t\tif (pokemon !== this.effectState.target) return;\r\n\t\t\tpokemon.addVolatile('unburden');\r\n\t\t},\r\n\t\tonTakeItem(item, pokemon) {\r\n\t\t\tpokemon.addVolatile('unburden');\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tpokemon.removeVolatile('unburden');\r\n\t\t},\r\n\t\tcondition: {\r\n\t\t\tonModifySpe(spe, pokemon) {\r\n\t\t\t\tif (!pokemon.item && !pokemon.ignoringAbility()) {\r\n\t\t\t\t\treturn this.chainModify(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Unburden\",\r\n\t\trating: 3.5,\r\n\t\tnum: 84,\r\n\t},\r\n\tunnerve: {\r\n\t\tonSwitchInPriority: 1,\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.effectState.unnerved) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Unnerve');\r\n\t\t\tthis.effectState.unnerved = true;\r\n\t\t},\r\n\t\tonEnd() {\r\n\t\t\tthis.effectState.unnerved = false;\r\n\t\t},\r\n\t\tonFoeTryEatItem() {\r\n\t\t\treturn !this.effectState.unnerved;\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Unnerve\",\r\n\t\trating: 1,\r\n\t\tnum: 127,\r\n\t},\r\n\tunseenfist: {\r\n\t\tonModifyMove(move) {\r\n\t\t\tif (move.flags['contact']) delete move.flags['protect'];\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Unseen Fist\",\r\n\t\trating: 2,\r\n\t\tnum: 260,\r\n\t},\r\n\tvesselofruin: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (this.suppressingAbility(pokemon)) return;\r\n\t\t\tthis.add('-ability', pokemon, 'Vessel of Ruin');\r\n\t\t},\r\n\t\tonAnyModifySpA(spa, source, target, move) {\r\n\t\t\tconst abilityHolder = this.effectState.target;\r\n\t\t\tif (source.hasAbility('Vessel of Ruin')) return;\r\n\t\t\tif (!move.ruinedSpA) move.ruinedSpA = abilityHolder;\r\n\t\t\tif (move.ruinedSpA !== abilityHolder) return;\r\n\t\t\tthis.debug('Vessel of Ruin SpA drop');\r\n\t\t\treturn this.chainModify(0.75);\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Vessel of Ruin\",\r\n\t\trating: 4.5,\r\n\t\tnum: 284,\r\n\t},\r\n\tvictorystar: {\r\n\t\tonAnyModifyAccuracyPriority: -1,\r\n\t\tonAnyModifyAccuracy(accuracy, target, source) {\r\n\t\t\tif (source.isAlly(this.effectState.target) && typeof accuracy === 'number') {\r\n\t\t\t\treturn this.chainModify([4506, 4096]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Victory Star\",\r\n\t\trating: 2,\r\n\t\tnum: 162,\r\n\t},\r\n\tvitalspirit: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'slp') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Vital Spirit');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'slp') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Vital Spirit');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tonTryAddVolatile(status, target) {\r\n\t\t\tif (status.id === 'yawn') {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Vital Spirit');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Vital Spirit\",\r\n\t\trating: 1.5,\r\n\t\tnum: 72,\r\n\t},\r\n\tvoltabsorb: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Electric') {\r\n\t\t\t\tif (!this.heal(target.baseMaxhp / 4)) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Volt Absorb');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Volt Absorb\",\r\n\t\trating: 3.5,\r\n\t\tnum: 10,\r\n\t},\r\n\twanderingspirit: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (source.getAbility().flags['failskillswap'] || target.volatiles['dynamax']) return;\r\n\r\n\t\t\tif (this.checkMoveMakesContact(move, source, target)) {\r\n\t\t\t\tconst targetCanBeSet = this.runEvent('SetAbility', target, source, this.effect, source.ability);\r\n\t\t\t\tif (!targetCanBeSet) return targetCanBeSet;\r\n\t\t\t\tconst sourceAbility = source.setAbility('wanderingspirit', target);\r\n\t\t\t\tif (!sourceAbility) return;\r\n\t\t\t\tif (target.isAlly(source)) {\r\n\t\t\t\t\tthis.add('-activate', target, 'Skill Swap', '', '', `[of] ${source}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.add('-activate', target, 'ability: Wandering Spirit', this.dex.abilities.get(sourceAbility).name, 'Wandering Spirit', `[of] ${source}`);\r\n\t\t\t\t}\r\n\t\t\t\ttarget.setAbility(sourceAbility);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Wandering Spirit\",\r\n\t\trating: 2.5,\r\n\t\tnum: 254,\r\n\t},\r\n\twaterabsorb: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Water') {\r\n\t\t\t\tif (!this.heal(target.baseMaxhp / 4)) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Water Absorb');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Water Absorb\",\r\n\t\trating: 3.5,\r\n\t\tnum: 11,\r\n\t},\r\n\twaterbubble: {\r\n\t\tonSourceModifyAtkPriority: 5,\r\n\t\tonSourceModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSourceModifySpAPriority: 5,\r\n\t\tonSourceModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Fire') {\r\n\t\t\t\treturn this.chainModify(0.5);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifyAtk(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Water') {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonModifySpA(atk, attacker, defender, move) {\r\n\t\t\tif (move.type === 'Water') {\r\n\t\t\t\treturn this.chainModify(2);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'brn') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Water Bubble');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'brn') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Water Bubble');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Water Bubble\",\r\n\t\trating: 4.5,\r\n\t\tnum: 199,\r\n\t},\r\n\twatercompaction: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (move.type === 'Water') {\r\n\t\t\t\tthis.boost({ def: 2 });\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Water Compaction\",\r\n\t\trating: 1.5,\r\n\t\tnum: 195,\r\n\t},\r\n\twaterveil: {\r\n\t\tonUpdate(pokemon) {\r\n\t\t\tif (pokemon.status === 'brn') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Water Veil');\r\n\t\t\t\tpokemon.cureStatus();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSetStatus(status, target, source, effect) {\r\n\t\t\tif (status.id !== 'brn') return;\r\n\t\t\tif ((effect as Move)?.status) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Water Veil');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Water Veil\",\r\n\t\trating: 2,\r\n\t\tnum: 41,\r\n\t},\r\n\tweakarmor: {\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (move.category === 'Physical') {\r\n\t\t\t\tthis.boost({ def: -1, spe: 2 }, target, target);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Weak Armor\",\r\n\t\trating: 1,\r\n\t\tnum: 133,\r\n\t},\r\n\twellbakedbody: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.type === 'Fire') {\r\n\t\t\t\tif (!this.boost({ def: 2 })) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Well-Baked Body');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Well-Baked Body\",\r\n\t\trating: 3.5,\r\n\t\tnum: 273,\r\n\t},\r\n\twhitesmoke: {\r\n\t\tonTryBoost(boost, target, source, effect) {\r\n\t\t\tif (source && target === source) return;\r\n\t\t\tlet showMsg = false;\r\n\t\t\tlet i: BoostID;\r\n\t\t\tfor (i in boost) {\r\n\t\t\t\tif (boost[i]! < 0) {\r\n\t\t\t\t\tdelete boost[i];\r\n\t\t\t\t\tshowMsg = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (showMsg && !(effect as ActiveMove).secondaries && effect.id !== 'octolock') {\r\n\t\t\t\tthis.add(\"-fail\", target, \"unboost\", \"[from] ability: White Smoke\", `[of] ${target}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"White Smoke\",\r\n\t\trating: 2,\r\n\t\tnum: 73,\r\n\t},\r\n\twimpout: {\r\n\t\tonEmergencyExit(target) {\r\n\t\t\tif (!this.canSwitch(target.side) || target.forceSwitchFlag || target.switchFlag) return;\r\n\t\t\tfor (const side of this.sides) {\r\n\t\t\t\tfor (const active of side.active) {\r\n\t\t\t\t\tactive.switchFlag = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttarget.switchFlag = true;\r\n\t\t\tthis.add('-activate', target, 'ability: Wimp Out');\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Wimp Out\",\r\n\t\trating: 1,\r\n\t\tnum: 193,\r\n\t},\r\n\twindpower: {\r\n\t\tonDamagingHitOrder: 1,\r\n\t\tonDamagingHit(damage, target, source, move) {\r\n\t\t\tif (move.flags['wind']) {\r\n\t\t\t\ttarget.addVolatile('charge');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSideConditionStart(side, source, sideCondition) {\r\n\t\t\tconst pokemon = this.effectState.target;\r\n\t\t\tif (sideCondition.id === 'tailwind') {\r\n\t\t\t\tpokemon.addVolatile('charge');\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: {},\r\n\t\tname: \"Wind Power\",\r\n\t\trating: 1,\r\n\t\tnum: 277,\r\n\t},\r\n\twindrider: {\r\n\t\tonStart(pokemon) {\r\n\t\t\tif (pokemon.side.sideConditions['tailwind']) {\r\n\t\t\t\tthis.boost({ atk: 1 }, pokemon, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target !== source && move.flags['wind']) {\r\n\t\t\t\tif (!this.boost({ atk: 1 }, target, target)) {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Wind Rider');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSideConditionStart(side, source, sideCondition) {\r\n\t\t\tconst pokemon = this.effectState.target;\r\n\t\t\tif (sideCondition.id === 'tailwind') {\r\n\t\t\t\tthis.boost({ atk: 1 }, pokemon, pokemon);\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Wind Rider\",\r\n\t\trating: 3.5,\r\n\t\t// We do not want Brambleghast to get Infiltrator in Randbats\r\n\t\tnum: 274,\r\n\t},\r\n\twonderguard: {\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (target === source || move.category === 'Status' || move.id === 'struggle') return;\r\n\t\t\tif (move.id === 'skydrop' && !source.volatiles['skydrop']) return;\r\n\t\t\tthis.debug('Wonder Guard immunity: ' + move.id);\r\n\t\t\tif (target.runEffectiveness(move) <= 0 || !target.runImmunity(move)) {\r\n\t\t\t\tif (move.smartTarget) {\r\n\t\t\t\t\tmove.smartTarget = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.add('-immune', target, '[from] ability: Wonder Guard');\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, failskillswap: 1, breakable: 1 },\r\n\t\tname: \"Wonder Guard\",\r\n\t\trating: 5,\r\n\t\tnum: 25,\r\n\t},\r\n\twonderskin: {\r\n\t\tonModifyAccuracyPriority: 10,\r\n\t\tonModifyAccuracy(accuracy, target, source, move) {\r\n\t\t\tif (move.category === 'Status' && typeof accuracy === 'number') {\r\n\t\t\t\tthis.debug('Wonder Skin - setting accuracy to 50');\r\n\t\t\t\treturn 50;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Wonder Skin\",\r\n\t\trating: 2,\r\n\t\tnum: 147,\r\n\t},\r\n\tzenmode: {\r\n\t\tonResidualOrder: 29,\r\n\t\tonResidual(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Darmanitan' || pokemon.transformed) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pokemon.hp <= pokemon.maxhp / 2 && !['Zen', 'Galar-Zen'].includes(pokemon.species.forme)) {\r\n\t\t\t\tpokemon.addVolatile('zenmode');\r\n\t\t\t} else if (pokemon.hp > pokemon.maxhp / 2 && ['Zen', 'Galar-Zen'].includes(pokemon.species.forme)) {\r\n\t\t\t\tpokemon.addVolatile('zenmode'); // in case of base Darmanitan-Zen\r\n\t\t\t\tpokemon.removeVolatile('zenmode');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonEnd(pokemon) {\r\n\t\t\tif (!pokemon.volatiles['zenmode'] || !pokemon.hp) return;\r\n\t\t\tpokemon.transformed = false;\r\n\t\t\tdelete pokemon.volatiles['zenmode'];\r\n\t\t\tif (pokemon.species.baseSpecies === 'Darmanitan' && pokemon.species.battleOnly) {\r\n\t\t\t\tpokemon.formeChange(pokemon.species.battleOnly as string, this.effect, false, '0', '[silent]');\r\n\t\t\t}\r\n\t\t},\r\n\t\tcondition: {\r\n\t\t\tonStart(pokemon) {\r\n\t\t\t\tif (!pokemon.species.name.includes('Galar')) {\r\n\t\t\t\t\tif (pokemon.species.id !== 'darmanitanzen') pokemon.formeChange('Darmanitan-Zen');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (pokemon.species.id !== 'darmanitangalarzen') pokemon.formeChange('Darmanitan-Galar-Zen');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonEnd(pokemon) {\r\n\t\t\t\tif (['Zen', 'Galar-Zen'].includes(pokemon.species.forme)) {\r\n\t\t\t\t\tpokemon.formeChange(pokemon.species.battleOnly as string);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1 },\r\n\t\tname: \"Zen Mode\",\r\n\t\trating: 0,\r\n\t\tnum: 161,\r\n\t},\r\n\tzerotohero: {\r\n\t\tonSwitchOut(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Palafin') return;\r\n\t\t\tif (pokemon.species.forme !== 'Hero') {\r\n\t\t\t\tpokemon.formeChange('Palafin-Hero', this.effect, true);\r\n\t\t\t\tpokemon.heroMessageDisplayed = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonSwitchIn(pokemon) {\r\n\t\t\tif (pokemon.baseSpecies.baseSpecies !== 'Palafin') return;\r\n\t\t\tif (!pokemon.heroMessageDisplayed && pokemon.species.forme === 'Hero') {\r\n\t\t\t\tthis.add('-activate', pokemon, 'ability: Zero to Hero');\r\n\t\t\t\tpokemon.heroMessageDisplayed = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflags: { failroleplay: 1, noreceiver: 1, noentrain: 1, notrace: 1, failskillswap: 1, cantsuppress: 1, notransform: 1 },\r\n\t\tname: \"Zero to Hero\",\r\n\t\trating: 5,\r\n\t\tnum: 278,\r\n\t},\r\n\r\n\t// CAP\r\n\tmountaineer: {\r\n\t\tonDamage(damage, target, source, effect) {\r\n\t\t\tif (effect && effect.id === 'stealthrock') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (move.type === 'Rock' && !target.activeTurns) {\r\n\t\t\t\tthis.add('-immune', target, '[from] ability: Mountaineer');\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisNonstandard: \"CAP\",\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Mountaineer\",\r\n\t\trating: 3,\r\n\t\tnum: -1,\r\n\t},\r\n\trebound: {\r\n\t\tisNonstandard: \"CAP\",\r\n\t\tonTryHitPriority: 1,\r\n\t\tonTryHit(target, source, move) {\r\n\t\t\tif (this.effectState.target.activeTurns) return;\r\n\r\n\t\t\tif (target === source || move.hasBounced || !move.flags['reflectable'] || target.isSemiInvulnerable()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newMove = this.dex.getActiveMove(move.id);\r\n\t\t\tnewMove.hasBounced = true;\r\n\t\t\tnewMove.pranksterBoosted = false;\r\n\t\t\tthis.actions.useMove(newMove, target, { target: source });\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tonAllyTryHitSide(target, source, move) {\r\n\t\t\tif (this.effectState.target.activeTurns) return;\r\n\r\n\t\t\tif (target.isAlly(source) || move.hasBounced || !move.flags['reflectable'] || target.isSemiInvulnerable()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newMove = this.dex.getActiveMove(move.id);\r\n\t\t\tnewMove.hasBounced = true;\r\n\t\t\tnewMove.pranksterBoosted = false;\r\n\t\t\tthis.actions.useMove(newMove, this.effectState.target, { target: source });\r\n\t\t\tmove.hasBounced = true; // only bounce once in free-for-all battles\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tflags: { breakable: 1 },\r\n\t\tname: \"Rebound\",\r\n\t\trating: 3,\r\n\t\tnum: -2,\r\n\t},\r\n\tpersistent: {\r\n\t\tisNonstandard: \"CAP\",\r\n\t\t// implemented in the corresponding move\r\n\t\tflags: {},\r\n\t\tname: \"Persistent\",\r\n\t\trating: 3,\r\n\t\tnum: -3,\r\n\t},\r\n};\r\n"
}
