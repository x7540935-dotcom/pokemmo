# Pokemmo Myself 依赖清单与安装说明

> 本文列出运行 `pokemmo myself` 所需的全部依赖及其**固定版本号**，并提供安装步骤。按照本文操作即可获得与当前项目一致的运行环境。

---

## 1. 基础运行环境

| 组件 | 指定版本 | 说明 |
| ---- | ---- | ---- |
| Node.js | 18.20.2 | 已在该版本下验证所有脚本、后端服务及 Playwright 测试 |
| npm | 10.7.0 | 与 Node 18.20.2 搭配的默认版本，可通过 `npm -v` 确认 |
| 现代浏览器 | Chrome 122.0.6261.128 | 用于加载前端页面与运行 WebSocket 客户端 |
| （可选）Playwright 运行时 | 见 [Playwright 安装](https://playwright.dev/docs/browsers) | 仅在需要执行 E2E 测试时安装 |

> 如需使用其他版本，请确保 Node.js 与 npm 的主版本一致，否则锁定依赖可能无法正确解析。

---

## 2. 根目录依赖（`pokemmo myself/package.json`）

### 2.1 运行时依赖

| 包名 | 版本 | 用途 |
| ---- | ---- | ---- |
| compression | 1.8.1 | 静态服务器压缩 |
| cors | 2.8.5 | 浏览器跨域支持 |
| express | 5.1.0 | 简单 HTTP 服务器与脚本接口 |
| fs-extra | 11.1.1 | 资源脚本的文件操作 |
| lodash | 4.17.21 | 工具脚本通用函数 |
| node-fetch | 3.3.1 | 拉取远程数据（Showdown 资源等） |
| socket.io | 4.7.2 | 旧版实时调试入口 |
| web-vitals | 5.1.0 | 前端性能监控依赖（同步 vendor） |
| ws | 8.13.0 | WebSocket 客户端与测试工具 |

### 2.2 开发 / 测试依赖

| 包名 | 版本 | 用途 |
| ---- | ---- | ---- |
| @playwright/test | 1.56.1 | 端到端测试框架 |
| @types/compression | 1.7.2 | TS 类型支持 |
| @types/cors | 2.8.13 | TS 类型支持 |
| @types/express | 4.17.21 | TS 类型支持 |
| @types/jest | 29.5.3 | TS 类型支持 |
| @types/lodash | 4.14.195 | TS 类型支持 |
| @types/node | 20.4.2 | TS 类型支持 |
| @types/ws | 8.5.5 | TS 类型支持 |
| eslint | 8.57.1 | 代码静态检查 |
| jest | 29.6.1 | 前端/脚本用单元测试 |
| nodemon | 3.0.1 | 开发时热重载 |
| typescript | 5.1.6 | TS 工具链（脚本、类型校验） |

### 2.3 安装命令

在 `pokemmo myself` 目录执行：

```bash
npm install \
  compression@1.8.1 \
  cors@2.8.5 \
  express@5.1.0 \
  fs-extra@11.1.1 \
  lodash@4.17.21 \
  node-fetch@3.3.1 \
  socket.io@4.7.2 \
  web-vitals@5.1.0 \
  ws@8.13.0 \
  @playwright/test@1.56.1 \
  @types/compression@1.7.2 \
  @types/cors@2.8.13 \
  @types/express@4.17.21 \
  @types/jest@29.5.3 \
  @types/lodash@4.14.195 \
  @types/node@20.4.2 \
  @types/ws@8.5.5 \
  eslint@8.57.1 \
  jest@29.6.1 \
  nodemon@3.0.1 \
  typescript@5.1.6
```

> 若使用 `package-lock.json`，直接运行 `npm install` 会自动按照锁定的版本安装；上表为明确列出依赖以便审核。

---

## 3. 后端服务依赖（`pokemmo myself/poke-proxy-server/package.json`）

### 3.1 运行时依赖

| 包名 | 版本 | 用途 |
| ---- | ---- | ---- |
| cors | 2.8.5 | WebSocket/HTTP 跨域 |
| dotenv | 16.4.5 | 配置文件读取 |
| express | 5.1.0 | HTTP 端点（健康检查 / 指标） |
| http-proxy-middleware | 3.0.5 | 资源代理、调试入口 |
| prom-client | 15.1.3 | Prometheus 指标导出 |

### 3.2 开发 / 测试依赖

| 包名 | 版本 | 用途 |
| ---- | ---- | ---- |
| jest | 29.7.0 | 后端单元/集成测试 |
| ws | 8.16.0 | WebSocket 测试客户端 |

### 3.3 安装命令

在 `pokemmo myself/poke-proxy-server` 目录执行：

```bash
npm install \
  cors@2.8.5 \
  dotenv@16.4.5 \
  express@5.1.0 \
  http-proxy-middleware@3.0.5 \
  prom-client@15.1.3 \
  jest@29.7.0 \
  ws@8.16.0
```

---

## 4. 额外工具（按需安装）

| 工具 | 版本 | 用途 |
| ---- | ---- | ---- |
| Playwright 浏览器二进制 | 与 `@playwright/test@1.56.1` 匹配 | `npx playwright install` 安装，用于 E2E |
| Git | 2.47.0 | 代码拉取 / 提交 |

---

## 5. 安装完成后的运行自检

1. **启动后端**
   ```bash
   cd "pokemmo myself/poke-proxy-server"
   node battle-server.js
   ```
2. **启动前端静态服务器**
   ```bash
   cd "pokemmo myself"
   node simple-http-server.js 8080
   ```
3. **访问页面**
   - `http://localhost:8080/pokemmo.html`
   - `http://localhost:8080/pvp-lobby.html`
4. **可选验证脚本**
   ```bash
   npm run validate:resources
   npm run lint
   npm run test
   cd poke-proxy-server && npm test
   ```

若上述步骤全部通过，说明依赖安装正确，可以正常运行并进行测试。若需要分享或部署到其他机器，只需保证安装列表与本文一致即可。*** End Patch*** End Patch

