<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>选择AI难度 - 宝可梦对战平台</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #e53935 0%, #e35d5b 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: #fff;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #3d7dca;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0 #ffcb05;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .difficulty-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 1200px) {
            .difficulty-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }
        
        @media (min-width: 900px) and (max-width: 1199px) {
            .difficulty-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .difficulty-card {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            border: 3px solid #ddd;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .difficulty-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: #3d7dca;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .difficulty-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border-color: #3d7dca;
        }

        .difficulty-card:hover::before {
            transform: scaleX(1);
        }

        .difficulty-card.selected {
            border-color: #ffcb05;
            background: linear-gradient(135deg, #fff9e6 0%, #ffe6cc 100%);
            box-shadow: 0 8px 20px rgba(255, 203, 5, 0.3);
        }

        .difficulty-card.selected::before {
            background: #ffcb05;
            transform: scaleX(1);
        }

        .difficulty-level {
            font-size: 1.8rem;
            font-weight: bold;
            color: #3d7dca;
            margin-bottom: 10px;
        }

        .difficulty-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .difficulty-description {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .difficulty-features {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .difficulty-features li {
            padding: 5px 0;
            color: #555;
            font-size: 0.9rem;
        }

        .difficulty-features li::before {
            content: "✓ ";
            color: #4caf50;
            font-weight: bold;
            margin-right: 5px;
        }

        .difficulty-stars {
            margin-top: 15px;
            font-size: 1.2rem;
            color: #ffcb05;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: #3d7dca;
            color: white;
        }

        .btn-primary:hover {
            background: #2a6cb8;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(61, 125, 202, 0.4);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
            border: 2px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e8e8e8;
            border-color: #bbb;
        }

        .team-check {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            text-align: center;
        }

        .team-check.error {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .team-check.success {
            background: #d4edda;
            border-color: #28a745;
        }

        @media (max-width: 768px) {
            .difficulty-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>选择AI难度</h1>
            <p>选择适合你的AI对手难度等级</p>
        </div>

        <div class="difficulty-grid" id="difficulty-grid">
            <!-- 难度卡片将通过JavaScript动态生成 -->
        </div>

        <div class="team-check" id="team-check">
            <p>正在检查队伍状态...</p>
        </div>

        <div class="actions">
            <button class="btn btn-secondary" onclick="window.location.href='pokemmo.html'">
                返回主页
            </button>
            <button class="btn btn-primary" id="start-battle-btn" disabled>
                开始对战
            </button>
        </div>
    </div>

    <script>
        // 难度配置
        const difficulties = [
            {
                level: 1,
                name: '新手',
                description: '适合初次体验的玩家，AI会随机选择行动',
                features: [
                    '完全随机选择',
                    '不考虑任何策略',
                    '快速响应',
                    '适合学习基础操作'
                ],
                stars: '⭐',
                responseTime: '<10ms'
            },
            {
                level: 2,
                name: '简单',
                description: 'AI会根据属性克制表选择技能',
                features: [
                    '基于属性克制选择',
                    '优先使用克制技能',
                    '不考虑伤害计算',
                    '适合入门练习'
                ],
                stars: '⭐⭐',
                responseTime: '<50ms'
            },
            {
                level: 3,
                name: '中等',
                description: 'AI会使用基础策略和属性克制进行决策',
                features: [
                    '属性克制 + 基础策略',
                    '考虑技能威力',
                    '简单的换人判断',
                    '适合常规对战'
                ],
                stars: '⭐⭐⭐',
                responseTime: '<100ms'
            },
            {
                level: 4,
                name: '高级',
                description: 'AI使用深度策略分析和所有辅助工具',
                features: [
                    '深度策略分析',
                    '伤害计算器',
                    '状态分析器',
                    '策略评估器',
                    'RAG知识库支持'
                ],
                stars: '⭐⭐⭐⭐',
                responseTime: '<200ms'
            },
            {
                level: 5,
                name: '专家',
                description: 'AI使用大语言模型和完整知识库进行智能决策',
                features: [
                    '大语言模型决策',
                    'RAG知识库查询',
                    '多轮推理',
                    '对手预测',
                    '长期战略规划'
                ],
                stars: '⭐⭐⭐⭐⭐',
                responseTime: '<1000ms'
            }
        ];

        let selectedDifficulty = null;

        // 检查队伍状态
        function checkTeam() {
            const teamCheck = document.getElementById('team-check');
            try {
                const saved = localStorage.getItem('pokemonTeam');
                if (!saved) {
                    teamCheck.className = 'team-check error';
                    teamCheck.innerHTML = '<p style="color: #dc3545; font-weight: bold;">❌ 队伍为空！请先组建队伍。</p>';
                    return false;
                }

                const team = JSON.parse(saved);
                const filledSlots = team.filter(p => p !== null).length;

                if (filledSlots < 6) {
                    teamCheck.className = 'team-check error';
                    teamCheck.innerHTML = `<p style="color: #dc3545; font-weight: bold;">❌ 队伍不完整！当前有 ${filledSlots}/6 只宝可梦。</p>`;
                    return false;
                }

                teamCheck.className = 'team-check success';
                teamCheck.innerHTML = `<p style="color: #28a745; font-weight: bold;">✓ 队伍完整！可以开始对战。</p>`;
                return true;
            } catch (e) {
                teamCheck.className = 'team-check error';
                teamCheck.innerHTML = '<p style="color: #dc3545; font-weight: bold;">❌ 队伍数据错误！</p>';
                return false;
            }
        }

        // 生成难度卡片
        function renderDifficulties() {
            const grid = document.getElementById('difficulty-grid');
            grid.innerHTML = '';

            difficulties.forEach(diff => {
                const card = document.createElement('div');
                card.className = 'difficulty-card';
                card.dataset.level = diff.level;

                card.innerHTML = `
                    <div class="difficulty-level">难度 ${diff.level}</div>
                    <div class="difficulty-name">${diff.name}</div>
                    <div class="difficulty-stars">${diff.stars}</div>
                    <div class="difficulty-description">${diff.description}</div>
                    <ul class="difficulty-features">
                        ${diff.features.map(f => `<li>${f}</li>`).join('')}
                    </ul>
                    <div style="margin-top: 10px; font-size: 0.85rem; color: #888;">
                        响应时间: ${diff.responseTime}
                    </div>
                `;

                card.addEventListener('click', () => selectDifficulty(diff.level));
                grid.appendChild(card);
            });
        }

        // 选择难度
        function selectDifficulty(level) {
            selectedDifficulty = level;

            // 更新卡片样式
            document.querySelectorAll('.difficulty-card').forEach(card => {
                if (parseInt(card.dataset.level) === level) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });

            // 更新按钮状态
            const startBtn = document.getElementById('start-battle-btn');
            const teamReady = checkTeam();
            startBtn.disabled = !teamReady;
        }

        // 开始对战
        function startBattle() {
            if (!selectedDifficulty) {
                alert('请先选择难度！');
                return;
            }

            if (!checkTeam()) {
                alert('队伍不完整，无法开始对战！');
                return;
            }

            // 跳转到对战页面，传递难度参数
            window.location.href = `battle.html?mode=ai&difficulty=${selectedDifficulty}`;
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderDifficulties();
            checkTeam();

            // 绑定开始对战按钮
            document.getElementById('start-battle-btn').addEventListener('click', startBattle);

            // 定期检查队伍状态
            setInterval(checkTeam, 2000);
        });
    </script>
</body>
</html>

